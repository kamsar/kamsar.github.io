<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Unicorn 4 Part III: Configuration Enhancements | Kam&#39;s Idea Log</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="TL;DR: Unicorn 4 prerelease is on NuGet right now! Now that that’s out of the way, let’s talk about another new Unicorn 4 feature: modular architecture friendly configurations.    When Habitat first l">
<meta property="og:type" content="article">
<meta property="og:title" content="Unicorn 4 Part III: Configuration Enhancements">
<meta property="og:url" content="https://kamsar.net/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/index.html">
<meta property="og:site_name" content="Kam&#39;s Idea Log">
<meta property="og:description" content="TL;DR: Unicorn 4 prerelease is on NuGet right now! Now that that’s out of the way, let’s talk about another new Unicorn 4 feature: modular architecture friendly configurations.    When Habitat first l">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://kamsar.net/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/everywhere.jpg">
<meta property="article:published_time" content="2017-02-28T03:03:31.000Z">
<meta property="article:modified_time" content="2021-07-26T23:19:02.505Z">
<meta property="article:author" content="Kam Figy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://kamsar.net/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/everywhere.jpg">
<meta name="twitter:creator" content="@kamsar">
  
    <link rel="alternative" href="/index.php/feed" title="Kam&#39;s Idea Log" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-62284328-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 5.4.0"></head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo">
        <span class="site-title">Kam&#39;s Idea Log</span>
        <span class="subtitle">C#, Jamstack, and Shenanigans</span>
      </a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        <div class="profile" id="profile-nav">
          <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://www.gravatar.com/avatar/314826f5d569260f26ac9f26f9e38b86?s=40" srcset="https://www.gravatar.com/avatar/314826f5d569260f26ac9f26f9e38b86?s=80 2x" alt="omg the beard"><i class="fa fa-caret-down"></i></a>
        </div>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="https://kamsar.net"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
      
        <td><a class="main-nav-link" href="/">Home</a></td>
      
        <td><a class="main-nav-link" href="/blog/archives">Archives</a></td>
      
      <td>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://kamsar.net"></form>
      </td>
      </tr>
    </table>
  </div>
  
</header>
    <div class="outer">
      <aside id="profile">
  <div class="inner profile-inner">
  	<div class="base-info profile-block">
		  <img id="avatar" src="https://www.gravatar.com/avatar/314826f5d569260f26ac9f26f9e38b86?s=128" srcset="https://www.gravatar.com/avatar/314826f5d569260f26ac9f26f9e38b86?s=256 2x" alt="#sitecorebeard">
      <h2 id="name">Kam Figy</h2>
      <h3 id="title">Principal Platform Architect at</h3>
      <a class="corp-logo" href="https://uniform.dev" target="_blank"><img src="/css/images/uniform-logo.svg" alt="Uniform" width="180"></a>
      <span id="location"><i class="fa fa-map-marker"></i>Vancouver, WA USA</span>
      <a id="follow" target="_blank" rel="noopener" href="https://twitter.com/kamsar">FOLLOW</a>
  	</div>
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
        
          <td><a target="_blank" rel="noopener" href="https://github.com/kamsar" title="github"><i class="fa fa-github"></i></a></td>
        
          <td><a target="_blank" rel="noopener" href="https://twitter.com/kamsar" title="twitter"><i class="fa fa-twitter"></i></a></td>
        
          <td><a href="/index.php/feed" title="rss"><i class="fa fa-rss"></i></a></td>
        
        </tr>
      </table>
    </div>
    <div class="article-info profile-block bio">
      <h2>About</h2>
      <p>Kam has been making websites since 1996, starting out with a 14.4k modem on a <a href="https://en.wikipedia.org/wiki/Party_line_(telephony)" target="_blank">party line</a> in the Hawaiian rainforest. A veteran developer, architect, and speaker, he's been working in the content management space for well over a decade. Kam is the author of <a href="https://github.com/kamsar/Unicorn" target="_blank">Unicorn</a>, <a href="https://github.com/kamsar/Synthesis" target="_blank">Synthesis</a>, <a href="https://github.com/kamsar/Dianoga" target="_blank">Dianoga</a>, and several other open-source libraries.</p>
    </div>
  </div>
</aside>
      <section id="main"><article id="post-Unicorn-4-Part-III-Configuration-Enhancements" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Unicorn 4 Part III: Configuration Enhancements
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/">
    <time datetime="2017-02-28T03:03:31.000Z" itemprop="datePublished">February 27, 2017</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>TL;DR: <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/Unicorn.Core/4.0.0-pre03">Unicorn 4 prerelease</a> is on NuGet right now!</p>
<p>Now that that’s out of the way, let’s talk about another new Unicorn 4 feature: <a target="_blank" rel="noopener" href="http://helix.sitecore.net/">modular architecture</a> friendly configurations. </p>
<img src="/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/everywhere.jpg" class="">

<p>When <a target="_blank" rel="noopener" href="https://github.com/Sitecore/Habitat">Habitat</a> first launched, I was mildly incredulous at the amount of duplication in its Unicorn configurations. Tons of tiny modules, all of which shared similar but not identical configurations (such as custom root folders) was not really a consideration when multiple configurations were originally conceived. Fast forward to today, and that’s a major use case that is more difficult than it needs to be.</p>
<p>Here’s an example of a Habitat Unicorn configuration:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">xmlns:patch</span>=<span class="string">&quot;http://www.sitecore.net/xmlconfig/&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">sitecore</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">unicorn</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configurations</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configuration</span> </span></span><br><span class="line"><span class="tag">        	<span class="attr">name</span>=<span class="string">&quot;Feature.News&quot;</span> </span></span><br><span class="line"><span class="tag">        	<span class="attr">description</span>=<span class="string">&quot;Feature News&quot;</span> </span></span><br><span class="line"><span class="tag">        	<span class="attr">dependencies</span>=<span class="string">&quot;Foundation.Serialization,Foundation.Indexing&quot;</span> </span></span><br><span class="line"><span class="tag">        	<span class="attr">patch:after</span>=<span class="string">&quot;configuration[@name=&#x27;Foundation.Serialization&#x27;]&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">targetDataStore</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\feature\news\serialization&quot;</span></span></span><br><span class="line"><span class="tag">                           <span class="attr">type</span>=<span class="string">&quot;Rainbow.Storage.SerializationFileSystemDataStore, Rainbow&quot;</span> <span class="attr">useDataCache</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">                           <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">predicate</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Predicates.SerializationPresetPredicate, Unicorn&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Templates&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/templates/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Renderings&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/layout/renderings/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Media&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/media library/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">roleDataStore</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Roles.Data.FilesystemRoleDataStore, Unicorn.Roles&quot;</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\feature\news\serialization\Feature.News.Roles&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">rolePredicate</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Roles.RolePredicates.ConfigurationRolePredicate, Unicorn.Roles&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">domain</span>=<span class="string">&quot;modules&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;^Feature News .*$&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">rolePredicate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configurations</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">unicorn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">sitecore</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>It’s long and it has a ton of boilerplate that is either identical in every module, or else defined by system conventions (e.g. physicalRootPath). We don’t need to be that verbose when using Unicorn 4. When we setup a modular, convention-based system using Unicorn 4 we can start by using <em>abstract configurations</em> to define the conventions of our system:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">name</span>=<span class="string">&quot;Habitat.Feature.Base&quot;</span> <span class="attr">abstract</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">targetDataStore</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\$(layer)\$(module)\serialization&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">predicate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;$(layer).$(module).Templates&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/templates/$(layer)/$(module)&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;$(layer).$(module).Renderings&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/layout/renderings/$(layer).$(module)&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;$(layer).$(module).Media&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/media library/$(layer).$(module)&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">roleDataStore</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Roles.Data.FilesystemRoleDataStore, Unicorn.Roles&quot;</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\$(layer)\$(module)\serialization\$(layer).$(module).Roles&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rolePredicate</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Roles.RolePredicates.ConfigurationRolePredicate, Unicorn.Roles&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">domain</span>=<span class="string">&quot;modules&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;^$(layer) $(module) .*$&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">rolePredicate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>This configuration defines a configuration that other configurations can <em>extend</em>. Because of its <code>abstract</code>-ness it is not a Unicorn configuration itself, only a template. Non-abstract configurations may also be extended.</p>
<p>This abstract configuration is also making use of Unicorn 4’s ability to do <em>variable replacement</em> in configurations. The <code>$(layer)</code> and <code>$(module)</code> variables are expanded in the extending configuration and are based on the convention of naming your configurations <code>Layer.Module</code>. You can also expand <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.CustomSerializationFolder.config.example#L42">more than one config per module</a> and <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.config#L190">use your own variables</a>. Using our abstract <code>Habitat.Feature.Base</code> configuration above, the same <code>Feature.News</code> configuration we started with can now be expressed much more simply:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">name</span>=<span class="string">&quot;Feature.News&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">description</span>=<span class="string">&quot;Feature News&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">dependencies</span>=<span class="string">&quot;Foundation.Serialization,Foundation.Indexing&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">extends</span>=<span class="string">&quot;Habitat.Feature.Base&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Nice huh? But what if you want to extend or replace a dependency in the inherited configuration? You can do that, too - and using Unicorn 4’s element inheritance system you can also do it very cleanly. Unicorn configurations have always been architecturally a set of independent IoC containers. The <code>&lt;defaults&gt;</code> node in <code>Unicorn.config</code> sets up the defaults, and then each configuration’s nodes override and replace the defaults if they exist. This is how you can <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.Configs.NewItemsOnly.example">deploy only new items</a> with the <code>NewItemsOnlyEvaluator</code> - you’re replacing the default evaluator with a different dependency implementation.</p>
<p>Unicorn 4 takes this a step further: with config inheritance, dependencies can be partially extended at an element level. You might have noticed this already in the <code>Habitat.Feature.Base</code> configuration, when we did this:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">targetDataStore</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\$(layer)\$(module)\serialization&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>In Unicorn 3, this would have required a <code>type</code> attribute. In Unicorn 4, <em>unless</em> you specify a <code>type</code> attribute, any attributes you add either replace or add to the default (or inherited) implementation. So instead this kept the same default dependency definition and <em>changed</em> an attribute on it - the <code>physicalRootPath</code>. </p>
<p>If you <em>do</em> specify a <code>type</code>, nothing is inherited and it works like Unicorn 3. Thus existing configurations will also work without modification :)</p>
<p>But what about things that have more than just attributes, like the <code>predicate</code>‘s <code>include</code> nodes? You can <em>append</em> elements in the inherited configuration in that case. If we take our <code>Habitat.Feature.Base</code> configuration above and extend it like this:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">predicate</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Foo&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/Foo&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>The end result is effectively:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">predicate</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Predicates.SerializationPresetPredicate, Unicorn&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Templates&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/templates/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Renderings&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/layout/renderings/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Media&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/media library/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Foo&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/Foo&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>You cannot remove inherited predicate nodes (or other dependencies that use children like <code>fieldFilter</code>), so plan accordingly: adding elements only.</p>
<p>And there you have it: with Unicorn 4 you can reasonably simply create serialization conventions for your modules and avoid configuration duplication - or if you’re not ready to go modular, you can at least enjoy not needing to have a <code>type</code> on most configuration nodes.</p>
<h2 id="But-Wait-There’s-More-🐘-The-Console-No-Longer-Sucks"><a href="#But-Wait-There’s-More-🐘-The-Console-No-Longer-Sucks" class="headerlink" title="But Wait, There’s More 🐘: The Console No Longer Sucks"></a>But Wait, There’s More 🐘: The Console No Longer Sucks</h2><h3 id="In-the-Control-Panel…"><a href="#In-the-Control-Panel…" class="headerlink" title="In the Control Panel…"></a>In the Control Panel…</h3><p>The Unicorn console has also received a serious upgrade in Unicorn 4. If you’ve ever run a sync that changed a large number of items from the Unicorn Control Panel, you may have noticed the browser slow to a crawl and the sync seem to almost stop. The console that underpins Unicorn 3 and earlier started to choke at around 500 lines. </p>
<p>No longer! Unicorn 4’s console has spit out <strong>100,000</strong> lines without a hitch.</p>
<h3 id="Automated-Tools-PowerShell-API"><a href="#Automated-Tools-PowerShell-API" class="headerlink" title="Automated Tools (PowerShell API)"></a>Automated Tools (PowerShell API)</h3><p>The automated tool console has also received an upgrade. Previously the tool console buffered all the output of a sync before sending it back. This caused problems in certain environments, namely Azure, where TCP connections that don’t send any data for more than 4 minutes are terminated. This would cause any long-running syncs in Azure to die unexpectedly.</p>
<p>In Unicorn 4 the automated tool console emits data in a stream just like the control panel console. There’s also a heartbeat timer where if no new console entries are made for 30 seconds, a <code>.</code> will be sent to make sure the connection is kept active. </p>
<p>The streaming console also requires updating your <code>Unicorn.psm1</code> file - not only will you get defense against TCP timeouts, you’ll also be able to see the sync occur in real-time using the PSAPI just like you would from the control panel. No more waiting until it’s done to see how things are going :)</p>
<h2 id="Can-I-have-it-yet"><a href="#Can-I-have-it-yet" class="headerlink" title="Can I have it yet?"></a>Can I have it yet?</h2><p>Absolutely. You can find <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/Unicorn/4.0.0-pre03">Unicorn 4.0.0-pre03</a> on NuGet right now!</p>
<h3 id="How-stable-is-this"><a href="#How-stable-is-this" class="headerlink" title="How stable is this?"></a>How stable is this?</h3><p>More stable than you might think. Unicorn 4 is largely additions, fixes, and enhancements to the already stable codebase behind Unicorn 3. The core pieces have not changed very much, unless you enable Dilithium and that’s optional. The new config inheritance stuff has 97% code coverage. That’s not to say it’s bug free either. If you find bugs <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues">let me know</a> and I’ll fix them :)</p>
<h3 id="What-about-installing-it"><a href="#What-about-installing-it" class="headerlink" title="What about installing it?"></a>What about installing it?</h3><p>Installation is just like Unicorn 3: Install the <code>Unicorn</code> NuGet package, and follow the directions in the README that will launch on installation to set up configuration(s).</p>
<p>NOTE: <a href="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/">Dilithium</a> ships disabled by default. If you want to enable it, make a <em>copy</em> of <code>Unicorn.Dilithium.config.example</code> and enable it.</p>
<h3 id="What-about-upgrading-to-it"><a href="#What-about-upgrading-to-it" class="headerlink" title="What about upgrading to it?"></a>What about upgrading to it?</h3><p>If you’re coming from classical Unicorn 3.1 or later, upgrading is actually really simple: just upgrade your NuGet package. Unicorn 4 changes nothing about storage or formatting (<em>except</em> that the <code>__Originator</code> field is no longer ignored by default), so all existing serialized items are compatible.</p>
<p>Taking advantage of the config enhancements detailed above is also entirely optional: Unicorn 3 configurations are totally readable by Unicorn 4.</p>
<p>If you’re invoking Unicorn via its PowerShell API, make sure to upgrade your <code>Unicorn.psm1</code> to the Unicorn 4 version to ensure correct error handling with the streaming console.</p>
<p>Have fun!</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/" data-id="ckrl9emyk004x98q7g23x8mj0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/index.php/2017/06/Simplifying-Contact-Facets-with-C-6/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Simplifying Contact Facets with C# 6
        
      </div>
    </a>
  
  
    <a href="/index.php/2017/02/Unicorn-4-Preview-Part-2-5-Generating-Packages-with-SPE/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Unicorn 4 Preview Part 2.5: Generating Unicorn Packages with SPE</div>
    </a>
  
</nav>

  
</article>

</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/JavaScript/">JavaScript</a></p>
              <p class="item-title"><a href="/index.php/2021/07/Fun-with-async-generators-and-for-await/" class="title">Fun with async generators and for await</a></p>
              <p class="item-date"><time datetime="2021-07-26T23:30:51.000Z" itemprop="datePublished">July 26, 2021</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/Jamstack/">Jamstack</a></p>
              <p class="item-title"><a href="/index.php/2020/08/Deploying-multiple-Netlify-sites-from-one-Git-repository/" class="title">Deploying multiple Netlify sites from one monorepo</a></p>
              <p class="item-date"><time datetime="2020-08-21T03:30:32.000Z" itemprop="datePublished">August 20, 2020</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/JSS/">JSS</a></p>
              <p class="item-title"><a href="/index.php/2019/09/Running-JSS-headless-mode-in-containers-part-2-Build-containers/" class="title">Running JSS headless mode in containers part 2: Build containers</a></p>
              <p class="item-date"><time datetime="2019-09-16T02:14:04.000Z" itemprop="datePublished">September 15, 2019</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/JSS/">JSS</a></p>
              <p class="item-title"><a href="/index.php/2019/09/Running-JSS-headless-mode-in-containers-part-1/" class="title">Running JSS headless mode in containers, part 1</a></p>
              <p class="item-date"><time datetime="2019-09-08T19:00:36.000Z" itemprop="datePublished">September 8, 2019</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/C/">C#</a></p>
              <p class="item-title"><a href="/index.php/2019/05/Build-2019-All-the-things/" class="title">Build 2019: All the things</a></p>
              <p class="item-date"><time datetime="2019-05-10T23:01:11.000Z" itemprop="datePublished">May 10, 2019</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/index.php/category/April-1/">April 1</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Blade/">Blade</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Build-Scripts/">Build Scripts</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/C/">C#</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Dianoga/">Dianoga</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/JSS/">JSS</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Jamstack/">Jamstack</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/JavaScript/">JavaScript</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Node-js/">Node.js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/">Sitecore</a><span class="category-list-count">39</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/Crypto/">Crypto</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/Lucene/">Lucene</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/MVC/">MVC</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/Search/">Search</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/xDB/">xDB</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Synthesis/">Synthesis</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Unicorn/">Unicorn</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/WebConsole/">WebConsole</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>&copy; 2021 Kam Figy</p>
      <p><small>Opinions expressed on this blog are my own, and not necessarily those of my employer.</small></p>
     <p><small>This work is licensed under a <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</small></p>
    </div>
  </div>
</footer>
    


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




<script src="/js/script.js"></script>


  </div>
</body>
</html>