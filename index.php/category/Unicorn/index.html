<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Category: Unicorn | Kam&#39;s Idea Log</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Kam&#39;s Idea Log">
<meta property="og:url" content="https://kamsar.net/index.php/category/Unicorn/index.html">
<meta property="og:site_name" content="Kam&#39;s Idea Log">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Kam Figy">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@kamsar">
  
    <link rel="alternative" href="/index.php/feed" title="Kam&#39;s Idea Log" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-62284328-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 5.4.0"></head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo">
        <span class="site-title">Kam&#39;s Idea Log</span>
        <span class="subtitle">C#, Jamstack, and Shenanigans</span>
      </a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        <div class="profile" id="profile-nav">
          <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://www.gravatar.com/avatar/314826f5d569260f26ac9f26f9e38b86?s=40" srcset="https://www.gravatar.com/avatar/314826f5d569260f26ac9f26f9e38b86?s=80 2x" alt="omg the beard"><i class="fa fa-caret-down"></i></a>
        </div>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="https://kamsar.net"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
      
        <td><a class="main-nav-link" href="/">Home</a></td>
      
        <td><a class="main-nav-link" href="/blog/archives">Archives</a></td>
      
      <td>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://kamsar.net"></form>
      </td>
      </tr>
    </table>
  </div>
  
  <div id="header-sub" class="header-sub header-inner">
    <div class="outer">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/index.php/category/April-1/">April 1</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Blade/">Blade</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Build-Scripts/">Build Scripts</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/C/">C#</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Dianoga/">Dianoga</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/JSS/">JSS</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Jamstack/">Jamstack</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/JavaScript/">JavaScript</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Node-js/">Node.js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/">Sitecore</a><span class="category-list-count">39</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Synthesis/">Synthesis</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Unicorn/">Unicorn</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/WebConsole/">WebConsole</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>
  
</header>
    <div class="outer">
      <aside id="profile">
  <div class="inner profile-inner">
  	<div class="base-info profile-block">
		  <img id="avatar" src="https://www.gravatar.com/avatar/314826f5d569260f26ac9f26f9e38b86?s=128" srcset="https://www.gravatar.com/avatar/314826f5d569260f26ac9f26f9e38b86?s=256 2x" alt="#sitecorebeard">
      <h2 id="name">Kam Figy</h2>
      <h3 id="title">Principal Platform Architect at</h3>
      <a class="corp-logo" href="https://uniform.dev" target="_blank"><img src="/css/images/uniform-logo.svg" alt="Uniform" width="180"></a>
      <span id="location"><i class="fa fa-map-marker"></i>Vancouver, WA USA</span>
      <a id="follow" target="_blank" rel="noopener" href="https://twitter.com/kamsar">FOLLOW</a>
  	</div>
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
        
          <td><a target="_blank" rel="noopener" href="https://github.com/kamsar" title="github"><i class="fa fa-github"></i></a></td>
        
          <td><a target="_blank" rel="noopener" href="https://twitter.com/kamsar" title="twitter"><i class="fa fa-twitter"></i></a></td>
        
          <td><a href="/index.php/feed" title="rss"><i class="fa fa-rss"></i></a></td>
        
        </tr>
      </table>
    </div>
    <div class="article-info profile-block bio">
      <h2>About</h2>
      <p>Kam has been making websites since 1996, starting out with a 14.4k modem on a <a href="https://en.wikipedia.org/wiki/Party_line_(telephony)" target="_blank">party line</a> in the Hawaiian rainforest. A veteran developer, architect, and speaker, he's been working in the content management space for well over a decade. Kam is the author of <a href="https://github.com/kamsar/Unicorn" target="_blank">Unicorn</a>, <a href="https://github.com/kamsar/Synthesis" target="_blank">Synthesis</a>, <a href="https://github.com/kamsar/Dianoga" target="_blank">Dianoga</a>, and several other open-source libraries.</p>
    </div>
  </div>
</aside>
      <section id="main">
  
  
    
    
      
        <div class="archive-year-wrap">
          <i class="fa fa-calendar"></i>
          <a href="/archives/2017" class="archive-year">2017</a>
        </div>
    
    <article id="post-Unicorn-4-Released" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2017/06/Unicorn-4-Released/">Unicorn 4 Released</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2017/06/Unicorn-4-Released/">
    <time datetime="2017-06-22T19:57:43.000Z" itemprop="datePublished">June 22, 2017</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://kamsar.net/nuget/unicorn/logo.png" alt="unicorn"></p>
<p>I‚Äôm happy to announce the final release of Unicorn 4.0! Unicorn 4 comes with significant performance and developer experience improvements, along with bug fixes. Unicorn 4 is available from NuGet or <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/releases/tag/4.0.0">GitHub</a>.</p>
<h1 id="Project-Dilithium-and-Performance"><a href="#Project-Dilithium-and-Performance" class="headerlink" title="Project Dilithium and Performance"></a>Project Dilithium and Performance</h1><p>Unicorn 4 is faster - a lot faster. Check out these benchmarks:</p>
<p><img src="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/perf.png" alt="performance benchmarks"></p>
<p>The speed increase is due to optimized caching routines, as well as the <em>Dilithium</em> batch processors. Dilithium is an optional feature that is off by default: because of its newness, it‚Äôs still experimental. I‚Äôm using it in production though. Give it a try - it can always be turned off without hurting anything.</p>
<p>For more detail into how Unicorn 4 is faster, and what Dilithium does, <a href="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/">check out this detailed blog post</a>.</p>
<h1 id="Improved-Modular-Configuration"><a href="#Improved-Modular-Configuration" class="headerlink" title="Improved Modular Configuration"></a>Improved Modular Configuration</h1><p>Unicorn 4 features a refactored configuration system that is designed to support <a target="_blank" rel="noopener" href="http://helix.sitecore.net/">Sitecore Helix</a> projects with an improved configuration experience. The new config system is completely backwards-compatible, but now enables <em>configuration inheritance</em>, <em>configuration variables</em>, and <em>configuration extension</em> so that modular projects can encode their conventions (e.g. paths to include, physical paths) into one base config and all the module configs can extend it.</p>
<p>This drastically reduces the verbosity of the module configurations, and improves their maintainability by allowing conventions to be <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a>. Here‚Äôs a very simple example of a base conventions configuration:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">name</span>=<span class="string">&quot;Habitat.Feature.Base&quot;</span> <span class="attr">abstract</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">targetDataStore</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\$(layer)\$(module)\serialization&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">predicate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;$(layer).$(module).Templates&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/templates/$(layer)/$(module)&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>And here‚Äôs a module configuration that extends it:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">name</span>=<span class="string">&quot;Feature.News&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">extends</span>=<span class="string">&quot;Habitat.Feature.Base&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- automatically stores items at $(sourceFolder)\Feature\News\serialization --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- automatically includes /sitecore/templates/Feature/News --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>There‚Äôs a lot more that you can do with the configuration enhancements in Unicorn 4 too. For additional details, <a href="https://kamsar.net/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/">read this extensive blog post</a>.</p>
<h1 id="Sitecore-PowerShell-Extensions-Support"><a href="#Sitecore-PowerShell-Extensions-Support" class="headerlink" title="Sitecore PowerShell Extensions Support"></a>Sitecore PowerShell Extensions Support</h1><p><img src="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/spe.png" alt="unicorn + spe"></p>
<p>Just about anything you can do with Unicorn can now be automated using Sitecore PowerShell Extensions in Unicorn 4. You can now run Unicorn SPE cmdlets to‚Ä¶</p>
<ul>
<li>Run a sync</li>
<li>Serialize an item or tree of items</li>
<li>Dump an item to YAML in the console</li>
<li><a href="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Part-2-5-Generating-Packages-with-SPE/">Create a Sitecore package of all the items in a Unicorn configuration</a></li>
<li>And there‚Äôs more, all <a href="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/">in this blog post</a> - and <a href="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Part-2-5-Generating-Packages-with-SPE/">this one, about packaging</a></li>
</ul>
<h1 id="Console-Output-Scaling"><a href="#Console-Output-Scaling" class="headerlink" title="Console Output Scaling"></a>Console Output Scaling</h1><p>The Unicorn console has received a serious upgrade in Unicorn 4. If you‚Äôve ever run a sync that changed a large number of items from the Unicorn Control Panel, you may have noticed the browser slow to a crawl and the sync seem to almost stop. The console that underpins Unicorn 3 and earlier started to choke at around 500 lines.</p>
<p>No longer! Unicorn 4‚Äôs upgraded console has spit out 100,000 lines without a hitch, and it should scale beyond that.</p>
<p>The automated tool console (PowerShell API) has also received an upgrade. Previously the tool console buffered all the output of a sync before sending it back. This caused problems in certain environments, namely Azure, where TCP connections that don‚Äôt send any data for more than four minutes are terminated. This would cause long-running syncs in Azure to die unexpectedly.</p>
<p>In Unicorn 4 the automated tool console emits data in a stream just like the control panel console. There‚Äôs also a heartbeat timer where if no new console entries are made for 30 seconds, a <code>.</code> will be sent to make sure the connection is kept active.</p>
<p>The streaming tool console also requires updating your <code>Unicorn.psm1</code> file - not only will you get defense against TCP timeouts, you‚Äôll also be able to see the sync occur in real time using the PSAPI just like you would from the control panel. No more waiting until it‚Äôs done to see how things are going :)</p>
<h1 id="Predicates-can-Exclude-by-Template-ID-or-Name"><a href="#Predicates-can-Exclude-by-Template-ID-or-Name" class="headerlink" title="Predicates can Exclude by Template ID or Name"></a>Predicates can Exclude by Template ID or Name</h1><p>Unicorn 4 can now exclude items from a configuration by template ID, thanks to <a target="_blank" rel="noopener" href="https://alan-null.github.io/2017/03/custom-unicorn-predicate">Alan P≈Ç√≥cieniak</a>. See also <a target="_blank" rel="noopener" href="https://alan-null.github.io/2017/03/custom-unicorn-predicate">Alan‚Äôs original post</a> on the technique.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Template ID&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/allowed&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclude</span> <span class="attr">templateId</span>=<span class="string">&quot;&#123;3B4F2B85-778D-44F3-9B2D-BEFF1F3575E6&#125;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>You can also exclude items by a regular expression of their name. This enables scenarios such as wanting to include all templates, but exclude all <code>__Standard values</code> items.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Name pattern&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/namepattern&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclude</span> <span class="attr">namePattern</span>=<span class="string">&quot;^__Standard values$&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>The complete grammar for predicates is always in the <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn.Tests/Predicates/TestConfiguration.xml#L32">predicate test config</a>.</p>
<h1 id="Breaking-Changes"><a href="#Breaking-Changes" class="headerlink" title="Breaking Changes"></a>Breaking Changes</h1><p>Unicorn 4‚Äôs breaking changes do not break any common use-cases of Unicorn, but review them to see if they affect you.</p>
<ul>
<li>The <code>__Originator</code> field is now <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/commit/f7d073b255891ec487e9a092fb2fa172ea77b9ac">serialized by default</a>. This enables proper tracking of the origin of items instantiated from branch templates.</li>
<li>Multithreaded sync support has been removed due to Sitecore bugs preventing realistic use. This was disabled by default already. Dilithium is faster than multithread sync ever was.</li>
<li>The Rainbow <code>UseLegacyAttributeFormatting</code> (formats items in Unicorn &lt; 3.1 format) setting has been removed. The new format is now always used. This has always been off by default.</li>
<li>Rainbow <code>FieldComparer</code>s are no longer activated using the Sitecore Factory, so they only support parameterless constructors (this would only affect custom comparers; the stock ones have always been parameterless)</li>
<li>Due to the console upgrades, a new <code>Unicorn.psm1</code> is required if you are using Unicorn‚Äôs PowerShell API. This file also now ships in the NuGet package, so you can be sure you‚Äôre getting the right version for your Unicorn.</li>
</ul>
<h1 id="Bug-Fixes"><a href="#Bug-Fixes" class="headerlink" title="Bug Fixes"></a>Bug Fixes</h1><ul>
<li>Transparent sync misc fixes (to renaming, saving display names, instantiating branch templates into TpSync areas)</li>
<li>Renaming an item and changing fields on it in one operation (only possible with Sitecore API) now no longer loses the additional field data in the serialized item</li>
<li>Improved output and logging, clarified messaging, improved developer experience</li>
<li>Content editor warnings now handle items in more than one configuration correctly</li>
<li>Control panel now displays which paths are invalid when initial serialization is blocked due to invalid include paths</li>
<li>The required password length for user serialization is now configurable, should you really really want to use <code>b</code></li>
<li>Using Fast Query while any Transparent Sync configuration is active will now log a warning to the Sitecore logs (fast query cannot find transparent sync items, so items may not be returned as expected). This can be disabled if your logs start to fill with spam and you understand the issue.</li>
<li>PowerShell API now defaults to not write secrets to the console (debug is off by default) for secure-by-default-ness</li>
<li>Fixed a background exception that could occur when modifying serialized items on disk in rare cases, which could cause the app pool to terminate <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/222">#222</a></li>
<li>The Rainbow data cache now correctly invalidates if an item is moved or renamed on disk after being added to the cache</li>
<li>Choosing many configurations to sync will no longer push the sync button off the page <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/pull/232">#232</a></li>
<li>The default console logging level for interactive syncing has been changed from Info to Debug, since there is no longer a scaling issue with the console output. This provides better insights into what has been changed on items without needing to see the Sitecore logs</li>
</ul>
<h1 id="Upgrading"><a href="#Upgrading" class="headerlink" title="Upgrading"></a>Upgrading</h1><p>If you‚Äôre coming from classical Unicorn 3.1 or later, upgrading is actually really simple: just upgrade your NuGet package. Unicorn 4 changes nothing about storage or formatting (except that the <code>__Originator</code> field is no longer ignored by default), so all existing serialized items are compatible.</p>
<p>If you‚Äôre invoking Unicorn via its remote PowerShell API, make sure to upgrade your <code>Unicorn.psm1</code> to the Unicorn 4 version to ensure correct error handling with the streaming console.</p>
<h1 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h1><p>Thank you to the community members who contributed code and bug reports to this release.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/chemaxa">chemaxa</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Rclemens">Raymond Clemens</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/niles11">Niles11</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/lordstyx">Luuk Ostendorf</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alan-null">Alan P≈Ç√≥cieniak</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/JamesSkemp">James Skemp</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/t00ki">t00ki</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/WimVergouwe">Wim Vergouwe</a></li>
</ul>
<h1 id="Address"><a href="#Address" class="headerlink" title="Address"></a>Address</h1><img src="/index.php/2017/06/Unicorn-4-Released/Elephant.jpg" class="" title="early design for Unicorn 5">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2017/06/Unicorn-4-Released/" data-id="ckrl9emym005198q72foh1qrb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
    <article id="post-Unicorn-4-Part-III-Configuration-Enhancements" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/">Unicorn 4 Part III: Configuration Enhancements</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/">
    <time datetime="2017-02-28T03:03:31.000Z" itemprop="datePublished">February 27, 2017</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>TL;DR: <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/Unicorn.Core/4.0.0-pre03">Unicorn 4 prerelease</a> is on NuGet right now!</p>
<p>Now that that‚Äôs out of the way, let‚Äôs talk about another new Unicorn 4 feature: <a target="_blank" rel="noopener" href="http://helix.sitecore.net/">modular architecture</a> friendly configurations. </p>
<img src="/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/everywhere.jpg" class="">

<p>When <a target="_blank" rel="noopener" href="https://github.com/Sitecore/Habitat">Habitat</a> first launched, I was mildly incredulous at the amount of duplication in its Unicorn configurations. Tons of tiny modules, all of which shared similar but not identical configurations (such as custom root folders) was not really a consideration when multiple configurations were originally conceived. Fast forward to today, and that‚Äôs a major use case that is more difficult than it needs to be.</p>
<p>Here‚Äôs an example of a Habitat Unicorn configuration:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">xmlns:patch</span>=<span class="string">&quot;http://www.sitecore.net/xmlconfig/&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">sitecore</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">unicorn</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configurations</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configuration</span> </span></span><br><span class="line"><span class="tag">        	<span class="attr">name</span>=<span class="string">&quot;Feature.News&quot;</span> </span></span><br><span class="line"><span class="tag">        	<span class="attr">description</span>=<span class="string">&quot;Feature News&quot;</span> </span></span><br><span class="line"><span class="tag">        	<span class="attr">dependencies</span>=<span class="string">&quot;Foundation.Serialization,Foundation.Indexing&quot;</span> </span></span><br><span class="line"><span class="tag">        	<span class="attr">patch:after</span>=<span class="string">&quot;configuration[@name=&#x27;Foundation.Serialization&#x27;]&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">targetDataStore</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\feature\news\serialization&quot;</span></span></span><br><span class="line"><span class="tag">                           <span class="attr">type</span>=<span class="string">&quot;Rainbow.Storage.SerializationFileSystemDataStore, Rainbow&quot;</span> <span class="attr">useDataCache</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">                           <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">predicate</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Predicates.SerializationPresetPredicate, Unicorn&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Templates&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/templates/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Renderings&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/layout/renderings/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Media&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/media library/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">roleDataStore</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Roles.Data.FilesystemRoleDataStore, Unicorn.Roles&quot;</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\feature\news\serialization\Feature.News.Roles&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">rolePredicate</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Roles.RolePredicates.ConfigurationRolePredicate, Unicorn.Roles&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">domain</span>=<span class="string">&quot;modules&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;^Feature News .*$&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">rolePredicate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configurations</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">unicorn</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">sitecore</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>It‚Äôs long and it has a ton of boilerplate that is either identical in every module, or else defined by system conventions (e.g. physicalRootPath). We don‚Äôt need to be that verbose when using Unicorn 4. When we setup a modular, convention-based system using Unicorn 4 we can start by using <em>abstract configurations</em> to define the conventions of our system:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">name</span>=<span class="string">&quot;Habitat.Feature.Base&quot;</span> <span class="attr">abstract</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">targetDataStore</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\$(layer)\$(module)\serialization&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">predicate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;$(layer).$(module).Templates&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/templates/$(layer)/$(module)&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;$(layer).$(module).Renderings&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/layout/renderings/$(layer).$(module)&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;$(layer).$(module).Media&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/media library/$(layer).$(module)&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">roleDataStore</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Roles.Data.FilesystemRoleDataStore, Unicorn.Roles&quot;</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\$(layer)\$(module)\serialization\$(layer).$(module).Roles&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rolePredicate</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Roles.RolePredicates.ConfigurationRolePredicate, Unicorn.Roles&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">domain</span>=<span class="string">&quot;modules&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;^$(layer) $(module) .*$&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">rolePredicate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>This configuration defines a configuration that other configurations can <em>extend</em>. Because of its <code>abstract</code>-ness it is not a Unicorn configuration itself, only a template. Non-abstract configurations may also be extended.</p>
<p>This abstract configuration is also making use of Unicorn 4‚Äôs ability to do <em>variable replacement</em> in configurations. The <code>$(layer)</code> and <code>$(module)</code> variables are expanded in the extending configuration and are based on the convention of naming your configurations <code>Layer.Module</code>. You can also expand <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.CustomSerializationFolder.config.example#L42">more than one config per module</a> and <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.config#L190">use your own variables</a>. Using our abstract <code>Habitat.Feature.Base</code> configuration above, the same <code>Feature.News</code> configuration we started with can now be expressed much more simply:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">name</span>=<span class="string">&quot;Feature.News&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">description</span>=<span class="string">&quot;Feature News&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">dependencies</span>=<span class="string">&quot;Foundation.Serialization,Foundation.Indexing&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">extends</span>=<span class="string">&quot;Habitat.Feature.Base&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Nice huh? But what if you want to extend or replace a dependency in the inherited configuration? You can do that, too - and using Unicorn 4‚Äôs element inheritance system you can also do it very cleanly. Unicorn configurations have always been architecturally a set of independent IoC containers. The <code>&lt;defaults&gt;</code> node in <code>Unicorn.config</code> sets up the defaults, and then each configuration‚Äôs nodes override and replace the defaults if they exist. This is how you can <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.Configs.NewItemsOnly.example">deploy only new items</a> with the <code>NewItemsOnlyEvaluator</code> - you‚Äôre replacing the default evaluator with a different dependency implementation.</p>
<p>Unicorn 4 takes this a step further: with config inheritance, dependencies can be partially extended at an element level. You might have noticed this already in the <code>Habitat.Feature.Base</code> configuration, when we did this:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">targetDataStore</span> <span class="attr">physicalRootPath</span>=<span class="string">&quot;$(sourceFolder)\$(layer)\$(module)\serialization&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>In Unicorn 3, this would have required a <code>type</code> attribute. In Unicorn 4, <em>unless</em> you specify a <code>type</code> attribute, any attributes you add either replace or add to the default (or inherited) implementation. So instead this kept the same default dependency definition and <em>changed</em> an attribute on it - the <code>physicalRootPath</code>. </p>
<p>If you <em>do</em> specify a <code>type</code>, nothing is inherited and it works like Unicorn 3. Thus existing configurations will also work without modification :)</p>
<p>But what about things that have more than just attributes, like the <code>predicate</code>‚Äòs <code>include</code> nodes? You can <em>append</em> elements in the inherited configuration in that case. If we take our <code>Habitat.Feature.Base</code> configuration above and extend it like this:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">predicate</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Foo&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/Foo&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>The end result is effectively:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">predicate</span> <span class="attr">type</span>=<span class="string">&quot;Unicorn.Predicates.SerializationPresetPredicate, Unicorn&quot;</span> <span class="attr">singleInstance</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Templates&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/templates/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Renderings&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/layout/renderings/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Feature.News.Media&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/media library/Feature/News&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;Foo&quot;</span> <span class="attr">database</span>=<span class="string">&quot;master&quot;</span> <span class="attr">path</span>=<span class="string">&quot;/sitecore/Foo&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">predicate</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>You cannot remove inherited predicate nodes (or other dependencies that use children like <code>fieldFilter</code>), so plan accordingly: adding elements only.</p>
<p>And there you have it: with Unicorn 4 you can reasonably simply create serialization conventions for your modules and avoid configuration duplication - or if you‚Äôre not ready to go modular, you can at least enjoy not needing to have a <code>type</code> on most configuration nodes.</p>
<h2 id="But-Wait-There‚Äôs-More-üêò-The-Console-No-Longer-Sucks"><a href="#But-Wait-There‚Äôs-More-üêò-The-Console-No-Longer-Sucks" class="headerlink" title="But Wait, There‚Äôs More üêò: The Console No Longer Sucks"></a>But Wait, There‚Äôs More üêò: The Console No Longer Sucks</h2><h3 id="In-the-Control-Panel‚Ä¶"><a href="#In-the-Control-Panel‚Ä¶" class="headerlink" title="In the Control Panel‚Ä¶"></a>In the Control Panel‚Ä¶</h3><p>The Unicorn console has also received a serious upgrade in Unicorn 4. If you‚Äôve ever run a sync that changed a large number of items from the Unicorn Control Panel, you may have noticed the browser slow to a crawl and the sync seem to almost stop. The console that underpins Unicorn 3 and earlier started to choke at around 500 lines. </p>
<p>No longer! Unicorn 4‚Äôs console has spit out <strong>100,000</strong> lines without a hitch.</p>
<h3 id="Automated-Tools-PowerShell-API"><a href="#Automated-Tools-PowerShell-API" class="headerlink" title="Automated Tools (PowerShell API)"></a>Automated Tools (PowerShell API)</h3><p>The automated tool console has also received an upgrade. Previously the tool console buffered all the output of a sync before sending it back. This caused problems in certain environments, namely Azure, where TCP connections that don‚Äôt send any data for more than 4 minutes are terminated. This would cause any long-running syncs in Azure to die unexpectedly.</p>
<p>In Unicorn 4 the automated tool console emits data in a stream just like the control panel console. There‚Äôs also a heartbeat timer where if no new console entries are made for 30 seconds, a <code>.</code> will be sent to make sure the connection is kept active. </p>
<p>The streaming console also requires updating your <code>Unicorn.psm1</code> file - not only will you get defense against TCP timeouts, you‚Äôll also be able to see the sync occur in real-time using the PSAPI just like you would from the control panel. No more waiting until it‚Äôs done to see how things are going :)</p>
<h2 id="Can-I-have-it-yet"><a href="#Can-I-have-it-yet" class="headerlink" title="Can I have it yet?"></a>Can I have it yet?</h2><p>Absolutely. You can find <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/Unicorn/4.0.0-pre03">Unicorn 4.0.0-pre03</a> on NuGet right now!</p>
<h3 id="How-stable-is-this"><a href="#How-stable-is-this" class="headerlink" title="How stable is this?"></a>How stable is this?</h3><p>More stable than you might think. Unicorn 4 is largely additions, fixes, and enhancements to the already stable codebase behind Unicorn 3. The core pieces have not changed very much, unless you enable Dilithium and that‚Äôs optional. The new config inheritance stuff has 97% code coverage. That‚Äôs not to say it‚Äôs bug free either. If you find bugs <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues">let me know</a> and I‚Äôll fix them :)</p>
<h3 id="What-about-installing-it"><a href="#What-about-installing-it" class="headerlink" title="What about installing it?"></a>What about installing it?</h3><p>Installation is just like Unicorn 3: Install the <code>Unicorn</code> NuGet package, and follow the directions in the README that will launch on installation to set up configuration(s).</p>
<p>NOTE: <a href="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/">Dilithium</a> ships disabled by default. If you want to enable it, make a <em>copy</em> of <code>Unicorn.Dilithium.config.example</code> and enable it.</p>
<h3 id="What-about-upgrading-to-it"><a href="#What-about-upgrading-to-it" class="headerlink" title="What about upgrading to it?"></a>What about upgrading to it?</h3><p>If you‚Äôre coming from classical Unicorn 3.1 or later, upgrading is actually really simple: just upgrade your NuGet package. Unicorn 4 changes nothing about storage or formatting (<em>except</em> that the <code>__Originator</code> field is no longer ignored by default), so all existing serialized items are compatible.</p>
<p>Taking advantage of the config enhancements detailed above is also entirely optional: Unicorn 3 configurations are totally readable by Unicorn 4.</p>
<p>If you‚Äôre invoking Unicorn via its PowerShell API, make sure to upgrade your <code>Unicorn.psm1</code> to the Unicorn 4 version to ensure correct error handling with the streaming console.</p>
<p>Have fun!</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2017/02/Unicorn-4-Part-III-Configuration-Enhancements/" data-id="ckrl9emyk004x98q7g23x8mj0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
    <article id="post-Unicorn-4-Preview-Part-2-5-Generating-Packages-with-SPE" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2017/02/Unicorn-4-Preview-Part-2-5-Generating-Packages-with-SPE/">Unicorn 4 Preview Part 2.5: Generating Unicorn Packages with SPE</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2017/02/Unicorn-4-Preview-Part-2-5-Generating-Packages-with-SPE/">
    <time datetime="2017-02-12T05:09:02.000Z" itemprop="datePublished">February 11, 2017</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/">Last time</a> we talked about how Sitecore PowerShell Extensions support was coming to Unicorn 4. This time, we‚Äôve got a new cmdlet to share.</p>
<p>Over time, many people have asked if there was a way to generate Sitecore packages from Unicorn. The answer has always been no, for many good reasons: packages install slowly, cannot ignore specific fields, or process advanced exclusions like a Unicorn predicate can. This makes them much less safe (and much slower) for deployment purposes compared to a remotely invoked Sync using deployed serialized items.</p>
<p>But there is a great use case for generating packages from Unicorn: authoring modules. As a module author, a method is needed to track the items that belong to your module and also to reliably create Sitecore packages for distribution of your module which contain those items. Unicorn is a natural fit for simply tracking module items, but it has lacked the ability to automatically push updates to release packages like it can to serialized items. This unnecessarily complicates things and reduces release reliability. That‚Äôs bad.</p>
<p>So when <a target="_blank" rel="noopener" href="https://twitter.com/MichaelWest101">Michael West</a> and <a target="_blank" rel="noopener" href="https://twitter.com/adamnaj">Adam Najmanowicz</a>, the authors of Sitecore PowerShell Extensions, asked if there was a way we could export Unicorn configurations to packages my answer was <em>absolutely.</em></p>
<p>SPE has long had <a target="_blank" rel="noopener" href="https://doc.sitecorepowershell.com/appendix/commands/Export-Package.html#examples">packaging support</a> built into it, and in fact SPE‚Äôs release packages are built using SPE. Unicorn packaging support is also implemented through SPE, and here‚Äôs how it works:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a new Sitecore Package (SPE cmdlet)</span></span><br><span class="line"><span class="variable">$pkg</span> = <span class="built_in">New-Package</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the Unicorn Configuration(s) we want to package</span></span><br><span class="line"><span class="variable">$configs</span> = <span class="built_in">Get-UnicornConfiguration</span> <span class="string">&quot;Foundation.*&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># Pipe the configs into New-UnicornItemSource </span></span><br><span class="line"><span class="comment"># to process them and add them to the package project</span></span><br><span class="line"><span class="comment"># (without -Project, this would emit the source object(s) </span></span><br><span class="line"><span class="comment">#   which can be manually added with $pkg.Sources.Add())</span></span><br><span class="line"><span class="variable">$configs</span> | <span class="built_in">New-UnicornItemSource</span> <span class="literal">-Project</span> <span class="variable">$pkg</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Export the package to a zip file on disk</span></span><br><span class="line"><span class="built_in">Export-Package</span> <span class="literal">-Project</span> <span class="variable">$pkg</span> <span class="literal">-Path</span> <span class="string">&quot;C:\foo.zip&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>And when you‚Äôre done with that, <code>c:\foo.zip</code> would contain a package that when installed will contain the entire contents of any Unicorn configuration matching <code>Foundation.*</code>.</p>
<p><code>New-UnicornItemSource</code> also accepts parameters to specify package installation options, exactly like SPE‚Äôs <a target="_blank" rel="noopener" href="https://doc.sitecorepowershell.com/appendix/commands/New-ExplicitItemSource.html">New-ExplicitItemSource</a>. This cmdlet is also very similar to how <code>New-UnicornItemSource</code> works: each item that is included in the configuration is added to the package as an explicit item source. Doing this also means that the exported package completely respects the Unicorn Predicate, including exclusions of child paths (note that if you specify <code>-InstallMode Overwrite</code>, excluded children may be deleted by the package).</p>
<h2 id="Questions"><a href="#Questions" class="headerlink" title="Questions?"></a>Questions?</h2><h3 id="Are-the-packaged-items-pulled-directly-from-the-serialized-items"><a href="#Are-the-packaged-items-pulled-directly-from-the-serialized-items" class="headerlink" title="Are the packaged items pulled directly from the serialized items?"></a>Are the packaged items pulled directly from the serialized items?</h3><p>No, they are pulled from the Sitecore database because the Sitecore packaging APIs work in <code>Item</code>s. So make sure to <em>sync</em> before you generate a package. Unless you‚Äôre using Transparent Sync in which case the items will already be up to date.</p>
<h3 id="Should-I-use-this-to-deploy-my-site"><a href="#Should-I-use-this-to-deploy-my-site" class="headerlink" title="Should I use this to deploy my site?"></a>Should I use this to deploy my site?</h3><p>No. As mentioned above, packages are a slower and more dangerous method to deploy item updates to your site.</p>
<h3 id="Does-this-mean-modules-will-start-requiring-Unicorn-üêò"><a href="#Does-this-mean-modules-will-start-requiring-Unicorn-üêò" class="headerlink" title="Does this mean modules will start requiring Unicorn? üêò"></a>Does this mean modules will start requiring Unicorn? üêò</h3><p>No. Unicorn would only be used in the development of the module, and the build process used to generate plain old Sitecore Packages for module releases. The module itself would need depend on neither Unicorn, Rainbow, or SPE.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Part-2-5-Generating-Packages-with-SPE/" data-id="ckrl9emyj004v98q748kzd9ko" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
    <article id="post-Unicorn-4-Preview-Part-2-SPE-Support" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/">Unicorn 4 Preview, Part 2: SPE Support</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/">
    <time datetime="2017-02-06T23:16:03.000Z" itemprop="datePublished">February 6, 2017</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Unicorn 4 will feature full support for <a target="_blank" rel="noopener" href="https://www.gitbook.com/book/sitecorepowershell/sitecore-powershell-extensions/details">Sitecore PowerShell Extensions</a> (SPE) to perform Unicorn actions. If you‚Äôve ever wanted deep programmatic control over Unicorn (for example ‚ÄúI want to sync Foundation.*‚Äù), or if you‚Äôve got an existing deployment process that‚Äôs already using SPE Remoting to perform deployment tasks - this is for you.</p>
<img src="/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/spe.png" class="">

<p>To use Unicorn cmdlets in SPE, all that is necessary is to install the SPE package along with Unicorn. Unicorn 4 comes with configuration that remains quiescent until SPE is installed that will automatically enable the Unicorn cmdlets. In case that‚Äôs not clear enough: SPE is an optional addition and will not be required to use Unicorn 4.</p>
<p>So what can we do with Unicorn cmdlets for SPE?</p>
<h2 id="Configurations"><a href="#Configurations" class="headerlink" title="Configurations"></a>Configurations</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Get one</span></span><br><span class="line"><span class="built_in">Get-UnicornConfiguration</span> <span class="string">&quot;Foundation.Foo&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get by filter</span></span><br><span class="line"><span class="built_in">Get-UnicornConfiguration</span> <span class="string">&quot;Foundation.*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get all</span></span><br><span class="line"><span class="built_in">Get-UnicornConfiguration</span></span><br></pre></td></tr></table></figure>

<p>The result of <code>Get-UnicornConfiguration</code> is an array of <code>IConfiguration</code> objects, which you can spelunk (e.g. with their <code>Name</code> property) or pass to other cmdlets. Configurations are read only.</p>
<h2 id="Syncing"><a href="#Syncing" class="headerlink" title="Syncing"></a>Syncing</h2><p>Sync cmdlets make use of <a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.utility/write-progress">Write-Progress</a> to provide a similar progress bar experience to the Control Panel, albeit a bit less responsive.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sync one</span></span><br><span class="line"><span class="built_in">Sync-UnicornConfiguration</span> <span class="string">&quot;Foundation.Foo&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sync multiple by name</span></span><br><span class="line"><span class="built_in">Sync-UnicornConfiguration</span> <span class="selector-tag">@</span>(<span class="string">&quot;Foundation.Foo&quot;</span>, <span class="string">&quot;Foundation.Bar&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sync multiple from pipeline</span></span><br><span class="line"><span class="built_in">Get-UnicornConfiguration</span> <span class="string">&quot;Foundation.*&quot;</span> | <span class="built_in">Sync-UnicornConfiguration</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sync all, except transparent sync-enabled configurations</span></span><br><span class="line"><span class="built_in">Get-UnicornConfiguration</span> | <span class="built_in">Sync-UnicornConfiguration</span> <span class="literal">-SkipTransparent</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Optionally set log output level (Debug, Info, Warn, Error)</span></span><br><span class="line"><span class="built_in">Sync-UnicornConfiguration</span> <span class="literal">-LogLevel</span> Warn</span><br></pre></td></tr></table></figure>

<p>For example:</p>
<img src="/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/sync.png" class="">

<h2 id="Partial-Syncing"><a href="#Partial-Syncing" class="headerlink" title="Partial Syncing"></a>Partial Syncing</h2><p>Sometimes you want to only sync a portion of a configuration. You can do that with PowerShell using <code>Sync-UnicornItem</code>.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sync a single item (note: must be under Unicorn control)</span></span><br><span class="line"><span class="built_in">Get-Item</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">Sync-UnicornItem</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sync multiple single items (note: all must be under Unicorn control)</span></span><br><span class="line"><span class="built_in">Get-ChildItem</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">Sync-UnicornItem</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># Sync an entire item tree, show only warnings and errors</span></span><br><span class="line"><span class="built_in">Get-Item</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">Sync-UnicornItem</span> <span class="literal">-Recurse</span> <span class="literal">-LogLevel</span> Warn</span><br></pre></td></tr></table></figure>

<h2 id="Reserializing"><a href="#Reserializing" class="headerlink" title="Reserializing"></a>Reserializing</h2><p>The cmdlet to reserialize is called <code>Export-UnicornConfiguration</code> because <code>Reserialize</code> is not an <a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/powershell/reference/5.0/microsoft.powershell.core/functions/get-verb">approved verb</a> for a cmdlet :)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reserialize one</span></span><br><span class="line"><span class="built_in">Export-UnicornConfiguration</span> <span class="string">&quot;Foundation.Foo&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Reserialize multiple by name</span></span><br><span class="line"><span class="built_in">Export-UnicornConfiguration</span> <span class="selector-tag">@</span>(<span class="string">&quot;Foundation.Foo&quot;</span>, <span class="string">&quot;Foundation.Bar&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reserialize from pipeline</span></span><br><span class="line"><span class="built_in">Get-UnicornConfiguration</span> <span class="string">&quot;Foundation.*&quot;</span> | <span class="built_in">Export-UnicornConfiguration</span></span><br></pre></td></tr></table></figure>

<h2 id="Partial-Reserializing"><a href="#Partial-Reserializing" class="headerlink" title="Partial Reserializing"></a>Partial Reserializing</h2><p>Sometimes you want to only reserialize a portion of a configuration. You can do that with PowerShell using <code>Export-UnicornItem</code>.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reserialize a single item (note: must be under Unicorn control)</span></span><br><span class="line"><span class="built_in">Get-Item</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">Export-UnicornItem</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Reserialize multiple single items (note: all must be under Unicorn control)</span></span><br><span class="line"><span class="built_in">Get-ChildItem</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">Export-UnicornItem</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># Reserialize an entire item tree</span></span><br><span class="line"><span class="built_in">Get-Item</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">Export-UnicornItem</span> <span class="literal">-Recurse</span></span><br></pre></td></tr></table></figure>

<h2 id="Converting-to-Raw-YAML"><a href="#Converting-to-Raw-YAML" class="headerlink" title="Converting to Raw YAML"></a>Converting to Raw YAML</h2><p>You can also dump out the raw YAML for an item - or items. The output of <code>ConvertTo-RainbowYaml</code> is either a string or array of strings depending on how many items were passed to it. Note that unless <code>-Raw</code> is specified, the default field formatters and excluded fields Unicorn ships with are used. These are non-customizable and do not follow Unicorn defaults if changed.</p>
<img src="/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/enyaml.png" class="">

<p>This capability enables casual use of YAML serialization without having to use Unicorn or set up a configuration. It‚Äôs not a good solution for general purpose synchronization though simply because the nuances of storing trees of items in files are many. Very many. But I‚Äôm curious what uses people will find for this :)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Convert an item to YAML format (always uses default excludes and field formatters)</span></span><br><span class="line"><span class="built_in">Get-Item</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">ConvertTo-RainbowYaml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert many items to YAML strings</span></span><br><span class="line"><span class="built_in">Get-ChildItem</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">ConvertTo-RainbowYaml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Disable all field formats and field filtering</span></span><br><span class="line"><span class="comment"># (e.g. disable XML pretty printing,</span></span><br><span class="line"><span class="comment"># and don&#x27;t ignore the Revision and Modified fields, etc)</span></span><br><span class="line"><span class="built_in">Get-Item</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">ConvertTo-RainbowYaml</span> <span class="literal">-Raw</span></span><br></pre></td></tr></table></figure>

<h2 id="Converting-from-Raw-YAML"><a href="#Converting-from-Raw-YAML" class="headerlink" title="Converting from Raw YAML"></a>Converting from Raw YAML</h2><img src="/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/convertfrom.png" class="">

<p>In Rainbow the <code>IItemData</code> interface is the internal unit of an Item. The <code>ConvertFrom-RainbowYaml</code> cmdlet converts raw YAML string(s) into <code>IItemData</code> which you can then spelunk as objects or deserialize as needed.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Get IItemDatas from YAML variable</span></span><br><span class="line"><span class="variable">$rawYaml</span> | <span class="built_in">ConvertFrom-RainbowYaml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get IItemData and disable all field filters</span></span><br><span class="line"><span class="comment"># (use this if you ran ConvertTo-RainbowYaml with -Raw)</span></span><br><span class="line"><span class="variable">$yaml</span> | <span class="built_in">ConvertFrom-RainbowYaml</span> <span class="literal">-Raw</span></span><br></pre></td></tr></table></figure>

<h2 id="Deserialization"><a href="#Deserialization" class="headerlink" title="Deserialization"></a>Deserialization</h2><p>To deserialize items, use <code>Import-RainbowItem</code> which takes <code>IItemData</code> items in and deserializes them into the Sitecore database. No comparison is done before deserialization, which makes this a bit slower than a full Unicorn sync.</p>
<img src="/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/elephant.png" class="">

<p>As a shorthand <code>Import-RainbowItem</code> also accepts YAML strings, however as <code>IItemData</code> can represent any sort of item, it is not limited only to deserializing YAML-sourced items.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deserialize IItemDatas from ConvertFrom-RainbowYaml</span></span><br><span class="line"><span class="variable">$rawYaml</span> | <span class="built_in">ConvertFrom-RainbowYaml</span> | <span class="built_in">Import-RainbowItem</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deserialize raw YAML from pipeline into Sitecore </span></span><br><span class="line"><span class="comment"># Shortcut bypassing ConvertFrom-RainbowYaml</span></span><br><span class="line"><span class="variable">$yaml</span> | <span class="built_in">Import-RainbowItem</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deserialize and disable all field filters</span></span><br><span class="line"><span class="comment"># (use this if you ran ConvertTo-RainbowYaml with -Raw)</span></span><br><span class="line"><span class="variable">$yaml</span> | <span class="built_in">Import-RainbowItem</span> <span class="literal">-Raw</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deserialize multiple at once</span></span><br><span class="line"><span class="variable">$yamlStringArray</span> | <span class="built_in">Import-RainbowItem</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Complete example that does nothing but eat CPU</span></span><br><span class="line"><span class="built_in">Get-ChildItem</span> <span class="string">&quot;/sitecore/content&quot;</span> | <span class="built_in">ConvertTo-RainbowYaml</span> | <span class="built_in">Import-RainbowItem</span></span><br></pre></td></tr></table></figure>

<h2 id="Questions"><a href="#Questions" class="headerlink" title="Questions?"></a>Questions?</h2><h3 id="Does-this-mean-the-existing-PowerShell-Remote-API-is-obsolete"><a href="#Does-this-mean-the-existing-PowerShell-Remote-API-is-obsolete" class="headerlink" title="Does this mean the existing PowerShell Remote API is obsolete?"></a>Does this mean the existing <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/tree/master/doc/PowerShell%20Remote%20Scripting">PowerShell Remote API</a> is obsolete?</h3><p>No. The existing PowerShell API uses Windows PowerShell to provide remote syncing capability and does not require installing <em>Sitecore</em> PowerShell. They serve different parallel purposes, and both are here to stay.</p>
<h3 id="You-have-no-gifs-or-memes-in-this-post-Is-something-wrong"><a href="#You-have-no-gifs-or-memes-in-this-post-Is-something-wrong" class="headerlink" title="You have no gifs or memes in this post. Is something wrong?"></a>You have no gifs or memes in this post. Is something wrong?</h3><p><img src="https://i.giphy.com/qZZAQDUNeXams.gif" alt="you mad?"></p>
<h3 id="Can-I-have-a-beta-yet"><a href="#Can-I-have-a-beta-yet" class="headerlink" title="Can I have a beta yet?"></a>Can I have a beta yet?</h3><p>I‚Äôll be releasing a beta once I finish the features I have planned. Yep, there‚Äôs at least one more ;)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Part-2-SPE-Support/" data-id="ckrl9emyi004r98q7beja0xdw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
    <article id="post-Unicorn-4-Preview-Project-Dilithium" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/">Unicorn 4 Preview, Part 1: Project Dilithium</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/">
    <time datetime="2017-02-02T04:51:13.000Z" itemprop="datePublished">February 1, 2017</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Not too long ago I was considering the future of Unicorn. Rather na√Øvely, I couldn‚Äôt think of all that much that needed fixing. I wondered if there would ever be a Unicorn 4. </p>
<p>Now since you‚Äôve read the title of this blog post, something tells me you don‚Äôt think that attitude lasted very long. It didn‚Äôt. Because there‚Äôs a pretty simple truth about Unicorn, even with all the <a href="https://kamsar.net/index.php/2015/09/Unicorn-3-What-s-new/#Performance-50-more-of-it">optimizations I put in to Unicorn 3</a>:</p>
<img src="/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/tdh.jpg" class="">

<p>There were two primary causes of this:</p>
<ol>
<li>The Sitecore API is slow and not suited to dealing with large quantities of items</li>
<li>Unicorn was originally designed to optimize for a few configurations, and Helix was blasting the number of active configurations to large numbers</li>
</ol>
<p>I found that the sync time was becoming annoyingly long. Long enough that it was a distraction, long enough that a piddly 20% faster from more profiling just wasn‚Äôt good enough.</p>
<p>What to do, what to do.</p>
<h2 id="Introducing-Project-Dilithium"><a href="#Introducing-Project-Dilithium" class="headerlink" title="Introducing Project Dilithium"></a>Introducing Project Dilithium</h2><p>I started on a crazy quest to speed up syncing performance. Sitecore‚Äôs recently added <a target="_blank" rel="noopener" href="https://stephenpope.github.io/publishing">Publishing Service</a> gained drastic speed gains in publishing by leveraging direct database access. Publishing, like syncing, is a batch-oriented operation. The Sitecore API is a single-item-oriented API. It does no optimizations, aside from caching, when you want more than one item. I resolved to try out SQL and see how it went. It went. See for yourself:</p>
<img src="/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/perf.png" class="">

<p>(benchmarks on i5-3570k@4GHz, SSDs, freshly restarted IIS + SQL, average of 3 runs each)</p>
<img src="/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/whoa.jpg" class="">

<h3 id="So-what-is-Dilithium"><a href="#So-what-is-Dilithium" class="headerlink" title="So what is Dilithium?"></a>So what is <a target="_blank" rel="noopener" href="http://bit.ly/2kjLK50">Dilithium</a>?</h3><p>There are two pieces of the Dilithium project: SQL and Serialized. Both operate in a similar fashion: before a sync operation begins, all items that will be involved in that sync are read in a single big batch either from SQL or disk. The actual sync then occurs against the pre-batched items. In case you‚Äôre wondering, the graph above <em>includes</em> the batching times for Dilithium - no cheating :)</p>
<p>The SQL version takes advantage of the <code>Descendants</code> table to grab all predicate-included items for every configuration in a single huge SQL query (this does mean that <code>FastQueryDescendantsDisabled</code> must be turned off). These items are then indexed and prepared for fast access. In this way, the entire data contents of the stock <code>core</code> database can be read in about 1500ms, compared to the Sitecore API‚Äôs 8 seconds.</p>
<p>The serialized version skips all the checks that usually are needed to traverse a Serialization File System tree - expensive operations that guarantee that the children you‚Äôre getting all belong to the same item ID, for example. It‚Äôs essentially reading all files sequentially and caching them for sync just like the SQL version.</p>
<p>When both DiSerialized and DiSQL are used together, they enable <em>parallel loading</em> of both sources at once. This reduces the load time quite significantly, as you can see on the shortest bar on the chart above.</p>
<h3 id="Questions"><a href="#Questions" class="headerlink" title="Questions?"></a>Questions?</h3><h4 id="Direct-SQL-are-you-nuts"><a href="#Direct-SQL-are-you-nuts" class="headerlink" title="Direct SQL, are you nuts?"></a>Direct SQL, are you nuts?</h4><p>Yes. Yes I am. Directly querying the Sitecore database is a terrible idea in almost every situation‚Ä¶except this. The schema for content has also been very stable for several major revisions of the product. And Stephen Pope said it was ok :)</p>
<h4 id="Is-it-any-faster-adding-or-modifying-items"><a href="#Is-it-any-faster-adding-or-modifying-items" class="headerlink" title="Is it any faster adding or modifying items?"></a>Is it any faster adding or modifying items?</h4><p>No. I‚Äôm not crazy enough to also do direct SQL writes, so all modifications go through normal Sitecore item saving APIs and perform pretty much the same as Unicorn 3. This also means that they‚Äôre mature, well-tested code - Unicorn 4 under the hood is not much different from v3, except for Dilithium.</p>
<h4 id="Can-I-turn-it-off"><a href="#Can-I-turn-it-off" class="headerlink" title="Can I turn it off?"></a>Can I turn it off?</h4><p>Heck yes. You can enable or disable Dilithium on a per-configuration basis. It also works just fine if you sync Dilithium and standard configurations together.</p>
<p>Serialized items and formats are identical between Dilithium and normal, so you can also enable and disable at will with no migration process.</p>
<h4 id="Will-this-eat-up-all-my-RAM"><a href="#Will-this-eat-up-all-my-RAM" class="headerlink" title="Will this eat up all my RAM?"></a>Will this eat up all my RAM?</h4><p>If you‚Äôre syncing gigabytes of media items‚Ä¶yes, definitely. For more normal developer and light content items, nope. DiSQL does not read blob data, so if you become RAM constrained turn off DiSerialized first.</p>
<p>Note that the precaches are disposed of immediately after the sync completes, so memory spikes are temporary.</p>
<h4 id="Let‚Äôs-address-the-üêò-in-the-room-how-is-Unicorn-4-60-faster-than-3-without-Dilithium"><a href="#Let‚Äôs-address-the-üêò-in-the-room-how-is-Unicorn-4-60-faster-than-3-without-Dilithium" class="headerlink" title="Let‚Äôs address the üêò in the room, how is Unicorn 4 60% faster than 3 without Dilithium?"></a>Let‚Äôs address the üêò in the room, how is Unicorn 4 60% faster than 3 without Dilithium?</h4><p>Actually pretty simple: eliminating a cache bombing that was done between syncing configurations that was needed for Transparent Sync. Well, it wasn‚Äôt needed if you‚Äôre syncing a non-Transparent configuration. Doing that meant that sites like Habitat with a ton of small non-Transparent configurations perform a <em>lot</em> faster.</p>
<h4 id="Any-other-performance-tricks"><a href="#Any-other-performance-tricks" class="headerlink" title="Any other performance tricks?"></a>Any other performance tricks?</h4><p>In my daily development I use a mix of Transparent Sync for developer items (templates, renderings), and standard sync for content items. Since Transparent Sync is disk-based anyway there is little point to running a sync on Transparent Sync configurations when you‚Äôre just doing local development. As such, there‚Äôs now an option to <em>skip</em> Transparent Sync-enabled configurations when you sync all. This is an option in the PowerShell API in Unicorn 4, as well as an option in the control panel (same place as log level).</p>
<p>Depending on how many Transparent Sync configurations you have, your time savings can be significant from enabling this. You should not however do this when deploying transparent configurations to a shared server.</p>
<h2 id="Can-I-have-it"><a href="#Can-I-have-it" class="headerlink" title="Can I have it?"></a>Can I have it?</h2><p>Not yet, it still needs some additional testing and vetting before I call it alpha. If you‚Äôre interested in being a brave early tester, get ahold of me on Sitecore Slack :)</p>
<h2 id="Is-this-the-only-new-thing-in-Unicorn-4"><a href="#Is-this-the-only-new-thing-in-Unicorn-4" class="headerlink" title="Is this the only new thing in Unicorn 4?"></a>Is this the only new thing in Unicorn 4?</h2><p>Nope. I‚Äôve got some more tricks up my sleeve, so stay tuned for some more preview blogs coming soon&trade;</p>
<p><img src="https://i.giphy.com/26uf80oUzpxWmuTOo.gif"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2017/02/Unicorn-4-Preview-Project-Dilithium/" data-id="ckrl9emyi004p98q7bq7805x0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
      
        <div class="archive-year-wrap">
          <i class="fa fa-calendar"></i>
          <a href="/archives/2016" class="archive-year">2016</a>
        </div>
    
    <article id="post-Unicorn-3-3-Released" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2016/10/Unicorn-3-3-Released/">Unicorn 3.3 Released</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2016/10/Unicorn-3-3-Released/">
    <time datetime="2016-10-27T03:54:07.000Z" itemprop="datePublished">October 26, 2016</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <img src="/nuget/unicorn/logo.png" class="">
<p>I‚Äôm happy to announce the release of Unicorn 3.3 and Rainbow 1.4. This is primarily a maintenance and bug fix release and is recommended for all users of Unicorn 3.x.</p>
<p>As there was no official announcement for Unicorn 3.2, this will also note what was new in 3.2. Items from 3.2 will be noted as such.</p>
<h2 id="What‚Äôs-new"><a href="#What‚Äôs-new" class="headerlink" title="What‚Äôs new?"></a>What‚Äôs new?</h2><h3 id="Improved-Configuration-Dependencies"><a href="#Improved-Configuration-Dependencies" class="headerlink" title="Improved Configuration Dependencies"></a>Improved Configuration Dependencies</h3><p>Dependencies between configurations have been improved to include <em>implicit</em> dependencies that are created when one configuration includes a path that is a child of another configuration. This simplifies the need to define explicit dependencies in many cases. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.Configs.Dependency.config.example#L32">This config file</a> documents how this works and how to disable it if you need to. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/165">#165</a></p>
<h3 id="Improved-Debugging-with-PowerShell-API"><a href="#Improved-Debugging-with-PowerShell-API" class="headerlink" title="Improved Debugging with PowerShell API"></a>Improved Debugging with PowerShell API</h3><p>You can now enable diagnostic logging of the CHAP base signature on the client and server side, so if you have issues getting the tool authentication working you can diagnose why. See <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/5b99817aa2e49d6c6a8e5ee8729ca9ccd465ea20/doc/PowerShell%20Remote%20Scripting/sample.ps1#L18">this</a> and <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/5b99817aa2e49d6c6a8e5ee8729ca9ccd465ea20/src/Unicorn/Standard%20Config%20Files/Unicorn.UI.config#L26">this</a> for configuration information. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/182">#182</a></p>
<h3 id="Full-Sitecore-8-2-Compatibility"><a href="#Full-Sitecore-8-2-Compatibility" class="headerlink" title="Full Sitecore 8.2 Compatibility"></a>Full Sitecore 8.2 Compatibility</h3><p>Unicorn and Rainbow now build against and require .NET 4.5.2 for Sitecore 8.2 compatibility. This means that <em>your project referencing Unicorn must also target framework 4.5.2 or later</em>, even if not using Sitecore 8.2. Unicorn should work with Sitecore 7 and later. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/175">#175</a></p>
<h3 id="3-2-Improved-Exclusion-Grammar"><a href="#3-2-Improved-Exclusion-Grammar" class="headerlink" title="(3.2) Improved Exclusion Grammar"></a>(3.2) Improved Exclusion Grammar</h3><p>You can now exclude children of a child of an included path. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/138">#138</a></p>
<h3 id="3-2-User-and-Role-Serialization"><a href="#3-2-User-and-Role-Serialization" class="headerlink" title="(3.2) User and Role Serialization"></a>(3.2) User and Role Serialization</h3><p>Unicorn 3.2 introduced YAML-based user and role serialization via the Unicorn.Users and Unicorn.Roles NuGet packages. User and role serialization works similarly to item serialization. To add this capability to your Unicorn installation you simply install the correct NuGet package and the readme will guide you, or you can read the documentation using the links below.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/Build/Unicorn.Roles.nuget/readme.txt">Roles README</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn.Roles/Standard%20Config%20Files/Unicorn.Configs.Default.Roles.config.example">How to configure roles</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/Build/Unicorn.Users.nuget/readme.txt">Users README</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn.Users/Standard%20Config%20Files/Unicorn.Configs.Default.Users.config.example">How to configure users</a></li>
</ul>
<h2 id="Bug-fixes"><a href="#Bug-fixes" class="headerlink" title="Bug fixes"></a>Bug fixes</h2><img src="/index.php/2016/10/Unicorn-3-3-Released/fixedbugs.jpg" class="">

<ul>
<li>When deserializing an item that contains a field missing in Sitecore, the field hint is shown instead of just its ID. This aids in tracking down the offending field, since it does not exist to find in the DB. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/169">#169</a></li>
<li>The <code>Unicorn.SharedSecret.config.example</code> has been renamed to include a <code>z</code> so that simply renaming it to use does not cause a config load order issue <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/181">#181</a></li>
<li>Fixed an issue with null vs empty field values that could cause an exception in Rainbow <a target="_blank" rel="noopener" href="https://github.com/kamsar/Rainbow/issues/16">#16</a></li>
<li>Fixed an issue that would cause missing language data when you removed a version from a tracked item using the Sitecore API within an <code>EventDisabler</code> block <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/168">#168</a></li>
<li>Fixed an error that occurred when an item changed template, but the old template was already deleted as part of the same sync process and thus no longer existed <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/164">#164</a></li>
<li>An issue that could cause spurious ‚ÄúItem changed, do you want to overwrite?‚Äù popups when saving an item in Experience Editor and using Transparent Sync has been fixed <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/163">#163</a></li>
<li>Fixed an issue that could cause a spurious Unicorn conflict warning when saving items with checkboxes in certain cases <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/151">#151</a></li>
<li>Serialized items with field values that equaled the standard values defined in the database are no longer left as standard values, and are correctly explicitly set to their serialized value. This was a common cause of items that ‚Äòsynced every time‚Äô. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/162">#162</a></li>
<li>Moving an item between Unicorn configurations will correctly respect exclusions that exclude some children of the target location <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/161">#161</a></li>
<li>Unicorn is now free of uses of <code>EditContext</code>, which is <a target="_blank" rel="noopener" href="http://sitecore.alexiasoft.nl/2006/04/03/new-way-of-editing-items/#comment-16">a 10-year-old antipattern</a> <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/160">#160</a></li>
<li>Pathing that escaped from the webroot using <code>~/</code> no longer breaks when set as the serialization path <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/157">#157</a></li>
<li>Errors about being unable to send headers after they have already been sent in Sitecore 8.1 Update-3 and later have been resolved <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/155">#155</a></li>
<li>Unicorn Auto Publish now works correctly if it is set to publish to more than one publishing target <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/152">#152</a></li>
<li>Renaming items whose filenames have been truncated on disk (very long db item names) will no longer result in the creation of duplicate files <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/146">#146</a></li>
<li>Items whose only change between db and disk is the <code>BranchID</code> are now synced correctly <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/144">#144</a></li>
<li>YAML values containing <code>\</code> and <code>&quot;</code> are now correctly treated as multiline values so that serialized files are valid YAML. This is a non-breaking change, but you may notice values such as <code>__Created by</code> being altered as items are saved. All Unicorn 3.x versions can parse either format without issue. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/143">#143</a></li>
<li>You can now explicitly add a wildcard item (an item named <code>*</code>) to a Unicorn configuration without it being interpreted as a wildcard character. See <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn.Tests/Predicates/TestConfiguration.xml#L81">test cases</a> <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/142">#142</a></li>
<li>The Unicorn data provider now returns <code>null</code> for <code>ChildIDs</code> if no children exist to enhance compatibility with the Sitecore data provider‚Äôs behaviour <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/141">#141</a></li>
<li>A race condition when using multithreaded sync and auto publishing has been fixed <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/183">#183</a></li>
<li>Rapidly clicking a checkbox in the control panel will no longer potentially corrupt the page state <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/158">#158</a></li>
<li>Unicorn and Rainbow both now reference Sitecore from the Official NuGet Feed, so if you need to build from source copying Sitecore assemblies is no longer required. Just clone and build!</li>
<li><strong>3.2</strong> Setting exclusions on a configuration that uses Transparent Sync is now an exception (this has never been a supported configuration, just now it‚Äôs an error too)</li>
<li><strong>3.2</strong> Configuration predicates with no include nodes are now an error instead of including all items</li>
</ul>
<h2 id="Upgrading"><a href="#Upgrading" class="headerlink" title="Upgrading"></a>Upgrading</h2><p>To upgrade to Unicorn 3.3, you need to make sure the project hosting Unicorn and Rainbow is targeting .NET 4.5.2 or later. Then simply upgrade the NuGet package, if you have Unicorn 3.1 or later.</p>
<p>For earlier versions, follow the upgrade instructions on the appropriate launch blog post (e.g. for 3.0 or 3.1) before you upgrade to 3.3.</p>
<h2 id="Installing"><a href="#Installing" class="headerlink" title="Installing"></a>Installing</h2><p>Install the <code>Unicorn</code> package from NuGet. A readme will be shown to help you get started after install. You must be using <code>packages.config</code> (NuGet 2.x style) package management for Unicorn and Rainbow, because they install content items to the project. If you wish to use <code>project.json</code> (NuGet 3.x style), you must manually install the configuration files for Unicorn and Rainbow because of limitations in NuGet 3.x.</p>
<h2 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h2><p>As usual Unicorn is not just me, it‚Äôs a community project. Thank you all for your pull requests, issue reports, and for using my work.</p>
<p>I‚Äôd like to specially thank Mark Cassidy for spending a lot of time tracking down - and fixing - some Unicorn issues he was having. All contributors to this release include:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/TAllen">Tyler Allen</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jason-booth">Jason Booth</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/cassidydotdk">Mark Cassidy</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/steeevec">Steve Crabb</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/JeffDarchuk">Jeff Darchuk</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/MadsDue">Mads Due</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Eldblom">Thomas Eldblom</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/HenkMahieu">HenkMahieu</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/blipson89">Ben Lipson</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mzizka">mzizka</a></li>
<li><a target="_blank" rel="noopener" href="http://sitecore.stackexchange.com/users/324/jawad">Jawad Sabra</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/istern">Thomas Stern</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/tonycwang">Tony Wang</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/wolfeno">wolfeno</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/eris86">Una Verhoeven</a></li>
</ul>
<img src="/index.php/2016/10/Unicorn-3-3-Released/theroom.gif" class="">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2016/10/Unicorn-3-3-Released/" data-id="ckrl9emyf004f98q70t1eggvs" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
    <article id="post-Unicorn-3-1-5-Released" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2016/03/Unicorn-3-1-5-Released/">Unicorn 3.1.5 Released</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2016/03/Unicorn-3-1-5-Released/">
    <time datetime="2016-03-24T04:31:57.000Z" itemprop="datePublished">March 23, 2016</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Unicorn 3.1.5 and Rainbow 1.3 are released to NuGet right now. This is a maintenance release. Upgrading is recommended, particularly if you are using Transparent Sync.</p>
<h2 id="New-Features"><a href="#New-Features" class="headerlink" title="New Features"></a>New Features</h2><h3 id="Link-DB-and-Indexing-support"><a href="#Link-DB-and-Indexing-support" class="headerlink" title="Link DB and Indexing support"></a>Link DB and Indexing support</h3><p>The new <code>&lt;syncConfiguration&gt;</code> dependency (see <code>Unicorn.config</code>) enables configurations to opt in to having synced items be updated into the link database and/or the search indexes after being changed by a sync.</p>
<p>This improves Unicorn‚Äôs compatibility with content syncing scenarios that are less developer focused, at the expense of reduced sync performance.</p>
<p>Transparent Sync also supports these flags, and items changed <em>while Sitecore is alive to see them</em> will have their links and indexes taken care of if set to do so. However if the IIS App Pool is not active during the file changes, nothing is updated.</p>
<h3 id="Per-configuration-concurrency"><a href="#Per-configuration-concurrency" class="headerlink" title="Per-configuration concurrency"></a>Per-configuration concurrency</h3><p>Unicorn 3 has always supported multithreaded sync and reserialize, but it has been disabled since release due to a concurrency bug in the Sitecore Template Engine that results in sync deadlocks when it is used to sync template item changes.</p>
<p>3.1.5 brings the ability to set the max thread count per-configuration (using the same <code>&lt;syncConfiguration&gt;</code> as indexing support) so that for configurations that are not syncing templates (or on Sitecore prior to 8.0U2) you may again enable concurrency. Threaded syncing can be 30-50% faster than non threaded.</p>
<h3 id="Control-panel-UX-improvements"><a href="#Control-panel-UX-improvements" class="headerlink" title="Control panel UX improvements"></a>Control panel UX improvements</h3><p>Unicorn 3.1.5 brings a ‚ÄòSync all‚Äô button to the control panel, and a few minor UI tweaks such as relegating the log verbosity to an options modal.</p>
<h2 id="Bug-Fixes"><a href="#Bug-Fixes" class="headerlink" title="Bug Fixes"></a>Bug Fixes</h2><ul>
<li>Checkboxes inherited through several layers of standard values will no longer result in the derived template being reset to base standard values</li>
<li>Auto-publish no longer will miss publishing unversioned fields in certain cases</li>
<li>Renaming or moving items with transparent sync enabled and data cache turned on no longer results in a corrupted data cache</li>
<li>Change Template now works correctly with transparent sync</li>
<li>Unicorn now understands content items that are using Sitecore 8.1 language fallback without creating extra versions on the serialized copy</li>
<li>The log verbosity feature has had several issues fixed that would result in logs incorrectly not being shown at the selected level</li>
<li>Unicorn‚Äôs Micro IoC container now understands int constructor parameters</li>
<li>Adding or changing serialized template items when using transparent sync will now correctly clear the template engine, preventing an error</li>
<li>Automated build powershell examples are now more flexible when invoked in unusual path locations</li>
<li>In the control panel, the batch action buttons will no longer ‚Äòoverlay‚Äô configuration checkboxes in certain situations</li>
<li>Logging of unversioned field updates will no longer incorrectly show a version number alongside the update in the logs</li>
<li>Certain unusual situations when syncing templates and items of that template will no longer throw a null reference due to stale caches</li>
</ul>
<h2 id="Upgrading"><a href="#Upgrading" class="headerlink" title="Upgrading"></a>Upgrading</h2><p>Upgrading from 3.1.4 is just a NuGet upgrade away. There are some config changes, so overwrite files and merge anything custom back in. Or even better use config patches and leave the default config alone :)</p>
<p>Note that Unicorn 3.1.5 changes the storage format for checkbox fields so that <em>unchecked</em> checkboxes are stored as ‚Äò0‚Äô instead of Sitecore‚Äôs standard blank value. This makes sync more reliable, however it does means that the first sync after serializing a new item with an unchecked checkbox will result in a ‚Äòchange‚Äô as the zero value is pushed back into the Sitecore database. Checkboxes that are already serialized with blank values will continue to work just fine as they are.</p>
<h1 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h1><p>Unicorn is a team effort of the Sitecore community. I‚Äôd like to thank the following folks who contributed to this release:</p>
<p><a target="_blank" rel="noopener" href="https://github.com/thesoftwarejedi">Dana Hanna</a><br><a target="_blank" rel="noopener" href="https://github.com/Gadensgaard">Kasper Gadensgaard</a><br><a target="_blank" rel="noopener" href="https://github.com/cassidydotdk">Mark Cassidy</a><br><a target="_blank" rel="noopener" href="https://github.com/TheCodeKing">Mike Carlisle</a><br><a target="_blank" rel="noopener" href="https://github.com/Krusen">S√∏ren Kruse</a><br><a target="_blank" rel="noopener" href="https://github.com/WizX20">WizX20</a></p>
<p>And extra special thanks to Robin Hermanussen, Richard Seal, Alex Washtell, Mark Cassidy, and everyone else I missed for tirelessly answering questions in #unicorn on Sitecore Slack when I‚Äôm busy or not around!</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2016/03/Unicorn-3-1-5-Released/" data-id="ckrl9emyb003z98q700vvb3tj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
    <article id="post-Unicorn-3-1-4-Released" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2016/02/Unicorn-3-1-4-Released/">Unicorn 3.1.4 Released</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2016/02/Unicorn-3-1-4-Released/">
    <time datetime="2016-02-29T04:19:12.000Z" itemprop="datePublished">February 28, 2016</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Unicorn 3.1.4 and Rainbow 1.2 are released to NuGet. This is a maintenance release which contains a few UX improvements and minor bug fixes and improvements.</p>
<h2 id="What‚Äôs-new"><a href="#What‚Äôs-new" class="headerlink" title="What‚Äôs new?"></a>What‚Äôs new?</h2><h3 id="Logging-Verbosity"><a href="#Logging-Verbosity" class="headerlink" title="Logging Verbosity"></a>Logging Verbosity</h3><p>The most obvious change is that you can now select a logging verbosity in the control panel. If you‚Äôve ever run a sync where many, many changes were synced you may have run into the issue where browsers start to crawl when fed that many log messages. Now you can choose to log only warnings or errors for that kind of situation. The Sitecore log files always get full verbosity, so you can see what exactly happened even if it was not written to the browser. Your verbosity setting is stored in a persistent cookie, so your selection is remembered.</p>
<p>Verbosity does not affect automated tools that invoke Unicorn. They always receive full verbosity. (<a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/112">#112</a>)</p>
<h3 id="XML-Field-Formatting-Improved"><a href="#XML-Field-Formatting-Improved" class="headerlink" title="XML Field Formatting Improved"></a>XML Field Formatting Improved</h3><p>XML fields are now stored by default with attributes on new lines. This further improves mergeability of Rainbow serialized items by allowing attribute merges. If you hate this idea, you can turn it off in <code>Rainbow.config</code>. (<a target="_blank" rel="noopener" href="https://github.com/kamsar/Rainbow/issues/12">#12</a>)</p>
<p>Rainbow 1.1:</p>
<pre><code>&lt;r xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;
  &lt;d id=&quot;&#123;FE5D7FDF-89C0-4D99-9AA3-B5FBD009C9F3&#125;&quot; l=&quot;&#123;0DAC6578-BC11-4B41-960A-E95F21A78D1F&#125;&quot; /&gt;
&lt;/r&gt;
</code></pre>
<p>Rainbow 1.2 (Unicorn 3.1.3+):</p>
<pre><code>&lt;r xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;
  &lt;d
    id=&quot;&#123;FE5D7FDF-89C0-4D99-9AA3-B5FBD009C9F3&#125;&quot;
    l=&quot;&#123;0DAC6578-BC11-4B41-960A-E95F21A78D1F&#125;&quot; /&gt;
&lt;/r&gt;
</code></pre>
<p>This formatting change is completely backwards compatible and no reserialization is required. As items are saved, they will be rewritten to use attributes on newlines.</p>
<h3 id="Fixes-amp-Minor-Improvements"><a href="#Fixes-amp-Minor-Improvements" class="headerlink" title="Fixes &amp; Minor Improvements"></a>Fixes &amp; Minor Improvements</h3><ul>
<li>The UX of the control panel has been streamlined to result in less vertical space for each configuration, a boon for setups like Habitat with lots of configurations.</li>
<li>Unicorn auto publishing now functions correctly on items with versions in several languages (<a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/114">#114</a>)</li>
<li>Using the ‚ÄúCopy to‚Äù function will no longer result in an incorrect serialized parent ID on the copied item. Other forms of duplication were not affected. (<a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/119">#119</a>)</li>
<li>Fixed a case where <code>NullReferenceException</code> was incorrectly thrown when using transparent sync (<a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/pull/117">#117</a>)</li>
<li>Fixed an error when duplicating items that did not exist in the database when using transparent sync (<a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/116">#116</a>)</li>
<li>Rainbow YAML formatting is more friendly to third party YAML parsers with the way it escapes values. This does mean that some values that did not previously get wrapped in double quotes (like GUIDs), will now have it going forward. Format is backwards compatible, no reserialize required. Items will upgrade to the new version on save. (<a target="_blank" rel="noopener" href="https://github.com/kamsar/Rainbow/issues/11">#11</a>)</li>
</ul>
<h2 id="Upgrading"><a href="#Upgrading" class="headerlink" title="Upgrading"></a>Upgrading</h2><p>To upgrade simply update your NuGet packages. There are no other steps required for this release <strong>unless coming from <a href="https://kamsar.net/index.php/2016/01/Unicorn-3-1-Released/">Unicorn 3.0.x</a></strong>. </p>
<p>If you wish to completely normalize your items to the latest Rainbow 1.2 format, you may reserialize them. But it is not a requirement, as Rainbow 1.2 can parse 1.1 serialized items.</p>
<h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><p>As usual, Unicorn updates are a community effort. Big thanks to the folks below for reporting bugs, sending pull requests, and general encouragement.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/agehrke">Andreas Gehrke</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/PetersonDave">Dave Peterson</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/TheCodeKing">Mike Carlisle</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/DotTech">Ruud van Falier</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/sbouwmeester">Sander Bouwmeester</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/stasmaxymov">Stanislav Maxymov</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2016/02/Unicorn-3-1-4-Released/" data-id="ckrl9emya003t98q78i8u56zw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
    <article id="post-Unicorn-3-1-Released" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2016/01/Unicorn-3-1-Released/">Unicorn 3.1 Released</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2016/01/Unicorn-3-1-Released/">
    <time datetime="2016-01-27T04:58:31.000Z" itemprop="datePublished">January 26, 2016</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Unicorn 3.1 and Rainbow 1.1 are released to NuGet. These updated versions bring several new features and a bunch of fixes. Upgrading is recommended for all users of Unicorn 3.0 due to the fixing of some data issues.</p>
<h2 id="What‚Äôs-new"><a href="#What‚Äôs-new" class="headerlink" title="What‚Äôs new?"></a>What‚Äôs new?</h2><h3 id="Configuration-Dependencies"><a href="#Configuration-Dependencies" class="headerlink" title="Configuration Dependencies"></a>Configuration Dependencies</h3><p>Unicorn configurations may now declare dependency relationships between each other. This is useful for example when one configuration may contain templates and another configuration might contain items based on those templates. With a dependency relationship the dependent configurations are guaranteed to always go first when configurations are synced. Transitive relationships (e.g. A -&gt; B -&gt; C) are supported.</p>
<p>Dependencies are defined using <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.Configs.Dependency.config.example">a dependencies attribute</a> on the configuration.</p>
<p>Dependencies <strong>do not</strong> force dependent configurations to sync. If config <code>A</code> depends on config <code>B</code> and you choose to sync only config <code>A</code>, <code>B</code> will not be synced. However if you sync <em>both</em> <code>A</code> and <code>B</code>, then <code>B</code> will always sync first due to the dependency.</p>
<h3 id="Include-Exclude-Predicate-Enhancements"><a href="#Include-Exclude-Predicate-Enhancements" class="headerlink" title="Include/Exclude Predicate Enhancements"></a>Include/Exclude Predicate Enhancements</h3><p>The predicate system has been significantly overhauled in Unicorn 3.1 to allow more advanced include and exclude scenarios.</p>
<ul>
<li><p>Exclude entries may now use paths relative to the parent <code>&lt;include&gt;</code> by omitting a leading slash. This would exclude <code>/foo/bar</code>: </p>
<pre><code>  &lt;include path=&quot;/foo&quot;&gt;
      &lt;exclude path=&quot;bar&quot; /&gt;
  &lt;/include&gt;
</code></pre>
</li>
</ul>
<ul>
<li><p>A new explicit grammar for excluding all children of an include has been introduced. This replaces the previous implicit grammar of adding a trailing slash (which still works but is deprecated).</p>
<pre><code>  &lt;include path=&quot;/foo&quot;&gt;
      &lt;exclude children=&quot;true&quot; /&gt;
  &lt;/include&gt;
</code></pre>
</li>
<li><p>The explicit children grammar supports <code>&lt;except&gt;</code> syntax to exclude all children <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn.Tests/Predicates/TestConfiguration.xml#L31">except for specific ones</a>.</p>
<pre><code>  &lt;include path=&quot;/somechildren&quot;&gt;
      &lt;exclude children=&quot;true&quot;&gt;
          &lt;except name=&quot;tests&quot; /&gt;
          &lt;except name=&quot;fests&quot; /&gt;
      &lt;/exclude&gt;
  &lt;/include&gt;
</code></pre>
</li>
<li><p>A new explicit grammar for excluding only children of a specific sub-path has been added. This grammar also supports <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn.Tests/Predicates/TestConfiguration.xml#L41"><code>&lt;except&gt;</code> syntax</a> and relative paths.</p>
<pre><code>  &lt;include path=&quot;/foo&quot;&gt;
      &lt;exclude childrenOfPath=&quot;/foo&quot; /&gt;
      &lt;exclude childrenOfPath=&quot;bar&quot;&gt; &lt;!-- /foo/bar/* --&gt;
          &lt;except name=&quot;quux&quot; /&gt; &lt;!-- include /foo/bar/quux --&gt;
      &lt;/exclude&gt;
  &lt;/include&gt;
</code></pre>
</li>
</ul>
<p>Take a look at the <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn.Tests/Predicates/TestConfiguration.xml">test predicate configuration</a> for examples of all available grammars.</p>
<h3 id="Control-Panel-Tool-Authentication"><a href="#Control-Panel-Tool-Authentication" class="headerlink" title="Control Panel Tool Authentication"></a>Control Panel Tool Authentication</h3><p>The method used to authenticate automated tools to Unicorn has been updated to be significantly more secure using a <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Challenge-Handshake_Authentication_Protocol">CHAP</a> implementation. This also comes with a handy <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/tree/master/doc/PowerShell%20Remote%20Scripting">PowerShell module</a> that you can use to simply invoke the handshake from a build script.</p>
<p>Should you require the legacy shared secret method, that is <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.UI.config#L24">still available but it is not the default</a>. Security is also now pluggable, if you wanted to use your own implementation.</p>
<p>The remote API ships disabled by default and you must activate it by <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.UI.config#L18">generating a random shared secret and adding it to the config</a>. This same secret must be known to invoke the API, and unlike the legacy API the secret is never transmitted directly.</p>
<h3 id="Breaking-Changes"><a href="#Breaking-Changes" class="headerlink" title="Breaking Changes"></a>Breaking Changes</h3><p>Unicorn 3.1 has some breaking changes compared to Unicorn 3.0, so upgrading requires reserializing your items to get them in a consistent format with the latest version. Unicorn 3.1 does understand Unicorn 3.0-formatted items, but Unicorn 3.0 <em>does not</em> understand Unicorn 3.1-formatted items. There will also be some repeated changes in the logs if you sync 3.0 items with 3.1, so usage with 3.0 items is not recommended.</p>
<p>Introducing breaking changes was a hard decision to make, but I think the saner defaults and new capabilities will justify the slightly more difficult upgrade process. So what‚Äôs breaking?</p>
<ul>
<li>The item‚Äôs database name is now stored in the serialized data (<a target="_blank" rel="noopener" href="https://github.com/kamsar/Rainbow/pull/7">#7</a>). This enables parsing serialized items in contexts where the database cannot easily be inferred, such as Courier.</li>
<li>Unversioned fields have official support and are nested under the <code>Language</code> instead of under a <code>Version</code> within the language which was incorrect. Prior to reserializing, syncing a 3.0-formatted item with 3.1 may result in messages that the field has been reset to standard values and then set again. <code>IItemData</code> now has an <code>UnversionedFields</code> property to store unversioned fields by language.</li>
<li>The name on serialized fields has been converted from a comment in the YAML into an actual parsed value. Note that this value is just a hint and if a template field is renamed it is NOT updated automatically.</li>
<li>The default setting of <code>Rainbow.SFS.ExtraInvalidFilenameCharacters</code> has been changed to <code>&quot;$&quot;</code> to make Rainbow compatible by default with TFS, and the TFS config example that previously set this has been removed.</li>
<li>The default setting for <code>Rainbow.SFS.SerializationFolderPathMaxLength</code> has been increased from <code>90</code> to <code>110</code> based on real world experience that 90 is too short.</li>
<li>The default setting for <code>Rainbow.SFS.MaxItemNameLengthBeforeTruncation</code> has been reduced from <code>100</code> to <code>30</code> based on real world experience that 100 was long enough to break the path length limitation for items with near 100 length names.</li>
<li>Automated deployment tools calling Unicorn have a new security API. See below for details on this, but it‚Äôs now more secure.</li>
</ul>
<h3 id="Other-Improvements"><a href="#Other-Improvements" class="headerlink" title="Other Improvements:"></a>Other Improvements:</h3><ul>
<li>Syncing dictionary items will now cause the dictionary cache to be cleared at the end of the sync, forcing the synced entries to be loaded.</li>
<li>The Unicorn Control Panel is now pipeline-based and extensible so that modules may define their own verbs or alter the UI if needed.</li>
<li>Error messages when serializing and deserializing XML-based fields (layout, rules) have been improved.</li>
<li>Unicorn and Rainbow both now utilize the C# 6.0 syntax and require the <a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/download/details.aspx?id=48159">C# 6.0 compiler</a> to build. They still target .NET 4.5.</li>
<li>Config file comments and documentation have been updated to cover the new features of Unicorn 3.1.</li>
</ul>
<h3 id="Bug-fixes"><a href="#Bug-fixes" class="headerlink" title="Bug fixes:"></a>Bug fixes:</h3><ul>
<li>Renaming or moving items which are serialized on loopback paths will no longer cause the serialized children to be deleted.</li>
<li>Missing field errors on the root item of a tree now result in a retry and non fatal error as expected.</li>
<li>A non fatal warning when syncing multiple configurations will no longer result in the sync stopping at the end of the configuration with the non fatal warning.</li>
<li>When using the New Items Only evaluator, you will no longer receive sync conflict warnings when saving items created by the evaluator.</li>
<li>Copying items when Transparent Sync is enabled and the source item is not in the Sitecore database now works correctly.</li>
<li>Empty field values will no longer cause problems when Transparent Sync is enabled.</li>
<li>XML-based fields (layout, rules) with empty values will no longer cause exceptions. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Rainbow/pull/6">#6</a>, <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/90">#90</a></li>
<li>Items installed by Sitecore packages or update packages into Unicorn configuration areas will no longer lose some field values in the serialized items. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/92">#92</a></li>
<li>Predicate include entries and SFS trees are no longer confused by paths which are different but start with similar bases, such as <code>/sitecore/content</code> and <code>/sitecore/content monkey</code></li>
<li>Plain text Unicorn logs returned to automated tool calls will no longer include HTML-encoded values such as <code>&amp;gt;</code></li>
<li>Naming items a <a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247(v=vs.85).aspx">Windows reserved file name</a> such as CON or COM1 will no longer result in an error. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Rainbow/issues/8">#8</a></li>
<li>Fields with a blank value in Sitecore that were not included in the serialized item were not being correctly reset to standard values. This has been fixed.</li>
</ul>
<h2 id="Upgrading"><a href="#Upgrading" class="headerlink" title="Upgrading"></a>Upgrading</h2><p>Ok so there are breaking changes, how do I upgrade? Thankfully it‚Äôs not too hard.</p>
<ol>
<li><strong>Before</strong> you upgrade, run a full sync of all configurations. If some have Transparent Sync enabled, turn that off during the upgrade. (you can reenable after step 4)</li>
<li>Upgrade your NuGet packages to Unicorn 3.1. (which will also install Rainbow 1.1)</li>
<li>Run a build of your solution, and if you develop out of webroot publish your changes.</li>
<li>Using the Unicorn control panel, <strong>Reserialize</strong> all configurations to flush them to disk as 3.1-format items.</li>
<li>If you use the automated tool API to do automated execution of Unicorn, migrate to the <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/tree/master/doc/PowerShell%20Remote%20Scripting">PowerShell module</a> to invoke the new API.</li>
<li>Have fun!</li>
</ol>
<h2 id="Contributors"><a href="#Contributors" class="headerlink" title="Contributors"></a>Contributors</h2><p>Unicorn 3.1 has seen contributions from many community members. Thank you all for your support, testing, bug reports, and contributions!</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/cassidydotdk">Mark Cassidy</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Eldblom">Thomas Eldblom</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/agehrke">Andreas Gerhke</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/OlegJytnik">Oleg Jytnik</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/patoncrispy">Chris Paton</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/drachele">Daniel Rachele</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/divamatrix">Lewanna Rathbun</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/guitarrich">Richard Seal</a></li>
<li><a target="_blank" rel="noopener" href="https://twitter.com/BerserkerDotNET">Andrii Snihyr</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/csteeg">Chris van de Steeg</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/GeorgeKarbyn">George Thomaidis</a></li>
<li><a target="_blank" rel="noopener" href="https://twitter.com/williamsk000">Kevin Williams</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/dashkodo">dashkodo</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/devstack">devstack</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/uandrei">uandrei</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2016/01/Unicorn-3-1-Released/" data-id="ckrl9emy9003r98q70jcl0y37" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    
    
      
        <div class="archive-year-wrap">
          <i class="fa fa-calendar"></i>
          <a href="/archives/2015" class="archive-year">2015</a>
        </div>
    
    <article id="post-Unicorn-3-0-2-Released" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/index.php/2015/11/Unicorn-3-0-2-Released/">Unicorn 3.0.2 Released</a>
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/index.php/2015/11/Unicorn-3-0-2-Released/">
    <time datetime="2015-11-04T06:17:49.000Z" itemprop="datePublished">November 3, 2015</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/index.php/category/Unicorn/">Unicorn</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn">Unicorn</a> 3.0.2 (and <a target="_blank" rel="noopener" href="https://github.com/kamsar/Rainbow">Rainbow</a> 1.0.1) have been released to NuGet. </p>
<p><em>This release includes some critical fixes to the serialization system, and upgrading is highly recommended for all users of <a href="https://kamsar.net/index.php/2015/10/Unicorn-3-0-Released/">Unicorn 3</a>.</em></p>
<h2 id="Improvements"><a href="#Improvements" class="headerlink" title="Improvements"></a>Improvements</h2><ul>
<li>Unicorn auto-publish now reports its activities to the sync console, and operates synchronously to guarantee published state for automated builds.</li>
<li>Guidance on some <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/wiki/The-Transparent-Sync-Guide">Transparent Sync pitfalls</a> has been added to the wiki.</li>
<li>The new <code>Rainbow.SFS.ExtraInvalidFilenameCharacters</code> setting enables TFS users to successfully serialize branch templates which begin in <code>$</code>, a reserved character by TFS. The <code>Rainbow.TFS.config.example</code> file is now shipped with Rainbow to illustrate its usage for TFS.</li>
<li>An <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/blob/master/src/Unicorn/Standard%20Config%20Files/Unicorn.Configs.SerializationFolder.config.example">example configuration file</a> to demonstrate how to move your serialized items elsewhere has been added.</li>
</ul>
<h2 id="Fixes"><a href="#Fixes" class="headerlink" title="Fixes"></a>Fixes</h2><ul>
<li><strong>CRITICAL</strong> Saving item versions that were not in the default Sitecore language was not updating the serialized item. This has been fixed. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/76">#76</a></li>
<li><strong>CRITICAL</strong> Serialization of significant empty field values, such as unchecked checkboxes when the standard value is checked, has been fixed. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/74">#74</a></li>
<li>Items that are restored from the Sitecore recycle bin or archive to Unicorn-controlled locations now result in the item being serialized on restore. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/72">#72</a></li>
<li>Resetting a field to standard values now correctly results in the field value being removed from the serialized item. <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/74">#74</a></li>
<li>Query string order is always respected when syncing multiple configurations at once using the control panel.</li>
<li>The serialization conflict dialog (if disk doesn‚Äôt match base item data on save) now formats correctly using HTML for Sitecore 8+</li>
<li>Using the <em>Dump Item</em> and <em>Dump Tree</em> commands in Sitecore to reserialize partial item trees now correctly serializes an item to all configurations that it may belong to, instead of just the first one.</li>
</ul>
<h2 id="Upgrading"><a href="#Upgrading" class="headerlink" title="Upgrading"></a>Upgrading</h2><p>Upgrading from Unicorn 3.x is as simple as updating your NuGet packages. If it prompts to overwrite any changed config files, I‚Äôd suggest doing so and using a diff with your source control to resolve differences.</p>
<p>If you suspect that you have serialized items that may be missing <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/74">significant empty values</a>, you should reserialize those after upgrading to get their values normalized.</p>
<h2 id="The-Credits"><a href="#The-Credits" class="headerlink" title="The Credits"></a>The Credits</h2><p>Unicorn isn‚Äôt just my project. Thanks a lot to all the community members who reported bugs, sent pull requests, and diagnosed issues to help make Unicorn better.</p>
<p>Unicorn 3.0.2 is brought to you by‚Ä¶</p>
<p><a target="_blank" rel="noopener" href="https://twitter.com/knifecore">Robin Hermanussen</a><br><a target="_blank" rel="noopener" href="https://twitter.com/TEldblom">Thomas Eldblom</a><br><a target="_blank" rel="noopener" href="https://twitter.com/cardinal252">Nathanael Mann</a><br><a target="_blank" rel="noopener" href="https://twitter.com/GeorgeKarbyn">@GeorgeKarbyn</a><br><a target="_blank" rel="noopener" href="https://twitter.com/williamsk000">Kevin Williams</a><br><a target="_blank" rel="noopener" href="https://github.com/amitthakur2014">@amitthakur2014</a><br><a target="_blank" rel="noopener" href="https://github.com/WizX20">@WizX20</a><br><a target="_blank" rel="noopener" href="https://twitter.com/kamsar">@kamsar</a><br>‚Ä¶and the rest of #unicorn on Sitecore Slack</p>
<p>As usual, if you run into trouble you can <a target="_blank" rel="noopener" href="https://github.com/kamsar/Unicorn/issues/new">submit an issue</a> on GitHub, hit me up on Sitecore Slack, or <a target="_blank" rel="noopener" href="https://twitter.com/kamsar">tweet at me</a>.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kamsar.net/index.php/2015/11/Unicorn-3-0-2-Released/" data-id="ckrl9emy9003p98q7e5s73jip" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/index.php/category/Unicorn/index.php/page/2/">2</a><a class="page-number" href="/index.php/category/Unicorn/index.php/page/3/">3</a><a class="extend next" rel="next" href="/index.php/category/Unicorn/index.php/page/2/">Next &amp;raquo;</a>
    </nav>
  
</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/JavaScript/">JavaScript</a></p>
              <p class="item-title"><a href="/index.php/2021/07/Fun-with-async-generators-and-for-await/" class="title">Fun with async generators and for await</a></p>
              <p class="item-date"><time datetime="2021-07-26T23:30:51.000Z" itemprop="datePublished">July 26, 2021</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/Jamstack/">Jamstack</a></p>
              <p class="item-title"><a href="/index.php/2020/08/Deploying-multiple-Netlify-sites-from-one-Git-repository/" class="title">Deploying multiple Netlify sites from one monorepo</a></p>
              <p class="item-date"><time datetime="2020-08-21T03:30:32.000Z" itemprop="datePublished">August 20, 2020</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/JSS/">JSS</a></p>
              <p class="item-title"><a href="/index.php/2019/09/Running-JSS-headless-mode-in-containers-part-2-Build-containers/" class="title">Running JSS headless mode in containers part 2: Build containers</a></p>
              <p class="item-date"><time datetime="2019-09-16T02:14:04.000Z" itemprop="datePublished">September 15, 2019</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/JSS/">JSS</a></p>
              <p class="item-title"><a href="/index.php/2019/09/Running-JSS-headless-mode-in-containers-part-1/" class="title">Running JSS headless mode in containers, part 1</a></p>
              <p class="item-date"><time datetime="2019-09-08T19:00:36.000Z" itemprop="datePublished">September 8, 2019</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/index.php/category/C/">C#</a></p>
              <p class="item-title"><a href="/index.php/2019/05/Build-2019-All-the-things/" class="title">Build 2019: All the things</a></p>
              <p class="item-date"><time datetime="2019-05-10T23:01:11.000Z" itemprop="datePublished">May 10, 2019</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/index.php/category/April-1/">April 1</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Blade/">Blade</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Build-Scripts/">Build Scripts</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/C/">C#</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Dianoga/">Dianoga</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/JSS/">JSS</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Jamstack/">Jamstack</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/JavaScript/">JavaScript</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Node-js/">Node.js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/">Sitecore</a><span class="category-list-count">39</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/Crypto/">Crypto</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/Lucene/">Lucene</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/MVC/">MVC</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/Search/">Search</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Sitecore/xDB/">xDB</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Synthesis/">Synthesis</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/Unicorn/">Unicorn</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/index.php/category/WebConsole/">WebConsole</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>&copy; 2021 Kam Figy</p>
      <p><small>Opinions expressed on this blog are my own, and not necessarily those of my employer.</small></p>
     <p><small>This work is licensed under a <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</small></p>
    </div>
  </div>
</footer>
    


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




<script src="/js/script.js"></script>


  </div>
</body>
</html>